[["index.html", "AlberdiLab | Aizpurua et al. 2024 New pond metagenomics Chapter 1 Introduction 1.1 Prepare the R environment", " AlberdiLab | Aizpurua et al. 2024 New pond metagenomics Ostaizka Aizpurua1 Carlos Cabido2 Garazi Martin Bideguren3 Antton Alberdi4 2024-06-28 Chapter 1 Introduction This webbook contains all the code used for data analysis in study of gut microbiomes of newts across ponds included in a restoration plan. 1.1 Prepare the R environment 1.1.1 Environment To reproduce all the analyses locally, clone this repository in your computer using: RStudio &gt; New Project &gt; Version Control &gt; Git And indicating the following git repository: https://github.com/alberdilab/newt_pond_metagenomics.git Once the R project has been created, follow the instructions and code chunks shown in this webbook. 1.1.2 Libraries The following R packages are required for the data analysis. # Base library(R.utils) library(knitr) library(tidyverse) library(devtools) library(tinytable) library(rairtable) library(rmarkdown) # For tree handling library(ape) library(phyloseq) library(phytools) # For plotting library(ggplot2) library(ggrepel) library(ggpubr) library(ggnewscale) library(gridExtra) library(ggtreeExtra) library(ggtree) library(ggh4x) library(UpSetR) # For statistics library(spaa) library(vegan) library(Rtsne) library(geiger) library(hilldiv2) library(distillR) library(ANCOMBC) library(lme4) library(nlme) library(emmeans) library(pairwiseAdonis) University of Copenhagen, ostaizka.aizpurua@sund.ku.dk↩︎ Aranzadi Science Society↩︎ University of Copenhagen, garazi.bideguren@sund.ku.dk↩︎ University of Copenhagen, antton.alberdi@sund.ku.dk↩︎ "],["prepare-data.html", "Chapter 2 Prepare data 2.1 Load data 2.2 Create working objects 2.3 Prepare color scheme 2.4 Prepare a phyloseq object 2.5 Wrap working objects", " Chapter 2 Prepare data 2.1 Load data Load the original data files outputted by the bioinformatic pipeline. 2.1.1 Sample metadata sample_metadata &lt;- read_tsv(&quot;data/DMB0157_metadata.tsv.gz&quot;) %&gt;% rename(sample=1) %&gt;% mutate(season = case_when( startsWith(sample, &quot;EHI01&quot;) ~ &quot;spring&quot;, startsWith(sample, &quot;EHI02&quot;) ~ &quot;autumn&quot;, TRUE ~ NA_character_ # Default case if no match )) %&gt;% mutate(type = case_when( region %in% c(&quot;Villabona&quot;,&quot;Oñati&quot;,&quot;Irun&quot;,&quot;Usurbil&quot;) ~ &quot;natural&quot;, region %in% c(&quot;Eskoriatza&quot;,&quot;Aia&quot;,&quot;Errenteria&quot;,&quot;Zarautz&quot;) ~ &quot;protected&quot;, region %in% c(&quot;Donostia&quot;,&quot;Orio&quot;) ~ &quot;urban&quot;, TRUE ~ NA_character_ # Default case if no match ))%&gt;% filter(sample_type==&quot;Faecal&quot;) 2.1.2 Read counts read_counts &lt;- read_tsv(&quot;data/DMB0157_counts.tsv.gz&quot;) %&gt;% rename(genome=1) %&gt;% select(c(&quot;genome&quot;,sample_metadata$sample)) 2.1.3 Genome taxonomy genome_metadata &lt;- read_tsv(&quot;data/DMB0157_mag_info.tsv.gz&quot;) %&gt;% rename(length=mag_size) %&gt;% semi_join(., read_counts, by = &quot;genome&quot;) %&gt;% arrange(match(genome,read_counts$genome)) 2.1.4 Genome base hits genome_coverage &lt;- read_tsv(&quot;data/DMB0157_coverage.tsv.gz&quot;) %&gt;% rename(genome=1) %&gt;% dplyr::select(c(&quot;genome&quot;,sample_metadata$sample)) %&gt;% semi_join(., genome_metadata, by = &quot;genome&quot;)%&gt;% arrange(match(genome, genome_metadata$genome)) 2.1.5 Genome tree genome_tree &lt;- read_tree(&quot;data/DMB0157.tree&quot;) genome_tree$tip.label &lt;- str_replace_all(genome_tree$tip.label,&quot;&#39;&quot;, &quot;&quot;) #remove single quotes in MAG names genome_tree &lt;- keep.tip(genome_tree, tip=genome_metadata$genome) # keep only MAG tips 2.1.6 Genome annotations genome_annotations &lt;- read_tsv(&quot;data/genome_annotations.tsv.xz&quot;) %&gt;% rename(gene=1, genome=2, contig=3) 2.2 Create working objects Transform the original data files into working objects for downstream analyses. 2.2.1 Filter reads by coverage min_coverage=0.3 read_counts_filt &lt;- genome_coverage %&gt;% mutate(across(where(is.numeric), ~ ifelse(. &gt; min_coverage, 1, 0))) %&gt;% mutate(across(-1, ~ . * read_counts[[cur_column()]])) 2.2.2 Transform reads into genome counts readlength=150 genome_counts &lt;- read_counts %&gt;% mutate(across(where(is.numeric), ~ . / (genome_metadata$length / readlength) )) readlength=150 genome_counts_filt &lt;- read_counts_filt %&gt;% mutate(across(where(is.numeric), ~ . / (genome_metadata$length / readlength) )) Sample without genome counts genome_counts_filt %&gt;% select_if(~ !is.numeric(.) || sum(.) == 0)%&gt;% select(-genome) %&gt;% colnames() #&quot;EHI02590&quot; Mag without reads genome_counts_filt %&gt;% filter(rowSums(across(where(is.numeric)))==0) %&gt;% column_to_rownames(., &quot;genome&quot;) %&gt;% rownames() #&quot;EHA02398_bin.22&quot; 2.2.3 Filter the data genome_counts_filt &lt;- genome_counts_filt %&gt;% select_if(~ !is.numeric(.) || sum(.) != 0)%&gt;% filter(rowSums(across(where(is.numeric)))!=0) genome_metadata &lt;- genome_metadata %&gt;% semi_join(., genome_counts_filt, by = &quot;genome&quot;) sample_metadata &lt;- sample_metadata %&gt;% filter(sample %in% colnames(genome_counts_filt)) genome_tree &lt;- keep.tip(genome_tree, tip=genome_metadata$genome) 2.2.4 Distill annotations into GIFTs genome_gifts_raw &lt;- distill(genome_annotations,GIFT_db,genomecol=2,annotcol=c(9,10,19), verbosity=F) genome_counts_filt_func &lt;- genome_counts_filt[genome_counts_filt$genome %in% rownames(genome_gifts),] genome_gifts &lt;- genome_gifts_raw[genome_counts_filt_func$genome,] genome_gifts &lt;- genome_gifts[, colSums(genome_gifts != 0) &gt; 0] 2.3 Prepare color scheme AlberdiLab projects use unified color schemes developed for the Earth Hologenome Initiative, to facilitate figure interpretation. phylum_colors &lt;- read_tsv(&quot;https://raw.githubusercontent.com/earthhologenome/EHI_taxonomy_colour/main/ehi_phylum_colors.tsv&quot;) %&gt;% right_join(genome_metadata, by=join_by(phylum == phylum)) %&gt;% arrange(match(genome, genome_tree$tip.label)) %&gt;% select(phylum, colors) %&gt;% unique() %&gt;% arrange(phylum) %&gt;% pull(colors, name=phylum) location_colors &lt;- c(&quot;#444D4F&quot;,&#39;#3D5C61&#39;,&#39;#41B6C0&#39;,&#39;#90C8C5&#39;,&#39;#E5D388&#39;,&#39;#BFA366&#39;,&quot;#bb6749&quot;,&quot;#834630&quot;,&#39;#6E5244&#39;) type_colors &lt;- c(&quot;#e6c9e0&quot;,&quot;#bd70ae&quot;,&quot;#753568&quot;) season_colors &lt;- c(&quot;#009270&quot;,&quot;#ac5c4c&quot;) 2.4 Prepare a phyloseq object phylo_samples &lt;- sample_metadata %&gt;% column_to_rownames(&quot;sample&quot;) %&gt;% sample_data() #convert to phyloseq sample_data object phylo_genome &lt;- genome_counts_filt %&gt;% column_to_rownames(&quot;genome&quot;) %&gt;% otu_table(., taxa_are_rows = TRUE) phylo_taxonomy &lt;- genome_metadata %&gt;% column_to_rownames(&quot;genome&quot;) %&gt;% as.matrix() %&gt;% tax_table() #convert to phyloseq tax_table object phylo_tree &lt;- phy_tree(genome_tree) physeq_genome &lt;- phyloseq(phylo_genome, phylo_taxonomy, phylo_samples,phylo_tree) physeq_genome_clr &lt;- microbiome::transform(physeq_genome, &#39;clr&#39;) 2.5 Wrap working objects All working objects are wrapped into a single Rdata object to facilitate downstream usage. save(sample_metadata, genome_metadata, read_counts, genome_counts, genome_counts_filt, genome_tree, genome_gifts_raw, genome_gifts, phylum_colors, location_colors, type_colors, physeq_genome, physeq_genome_clr, file = &quot;data/data.Rdata&quot;) "],["data-statistics.html", "Chapter 3 Data statistics 3.1 Sequencing reads statistics 3.2 DNA fractions 3.3 Recovered microbial fraction", " Chapter 3 Data statistics load(&quot;data/data.Rdata&quot;) 3.1 Sequencing reads statistics sample_metadata %&gt;% summarise(Total=sum(reads_post_fastp * 150 / 1000000000) %&gt;% round(2), mean=mean(reads_post_fastp * 150 / 1000000000) %&gt;% round(2), sd=sd(reads_post_fastp * 150 / 1000000000) %&gt;% round(2)) %&gt;% unite(&quot;Average&quot;,mean, sd, sep = &quot; ± &quot;, remove = TRUE) %&gt;% tt() tinytable_qo4xugb1ilzo7n939iv2 .table td.tinytable_css_orin2seele0n2ih1fu7y, .table th.tinytable_css_orin2seele0n2ih1fu7y { border-bottom: solid 0.1em #d3d8dc; } Total Average 398.22 4.33 ± 1.45 3.2 DNA fractions sequence_fractions &lt;- read_counts %&gt;% pivot_longer(-genome, names_to = &quot;sample&quot;, values_to = &quot;value&quot;) %&gt;% group_by(sample) %&gt;% summarise(mags = sum(value)) %&gt;% left_join(sample_metadata, by = join_by(sample == sample)) %&gt;% dplyr::select(sample,mags,metagenomic_bases,host_bases,bases_lost_fastp_percent) %&gt;% mutate(mags_bases = mags*146) %&gt;% mutate(lowqual_bases = ((metagenomic_bases+host_bases)/(1-bases_lost_fastp_percent))-(metagenomic_bases+host_bases)) %&gt;% mutate(unmapped_bases = metagenomic_bases - mags_bases) %&gt;% mutate(unmapped_bases = ifelse(unmapped_bases &lt; 0, 0, unmapped_bases)) %&gt;% dplyr::select(sample, lowqual_bases, host_bases, unmapped_bases, mags_bases) sequence_fractions %&gt;% mutate_at(vars(-sample), ~./1000000000) %&gt;% rename(&quot;Sample&quot;=1, &quot;Low quality&quot;=2, &quot;Mapped to host&quot;=3, &quot;Unmapped&quot;=4, &quot;Mapped to MAGs&quot;=5) %&gt;% tt() tinytable_9x3p2yliz4yc1w7upqpa .table td.tinytable_css_v0vn92hdl3e9dnyrq5nm, .table th.tinytable_css_v0vn92hdl3e9dnyrq5nm { border-bottom: solid 0.1em #d3d8dc; } Sample Low quality Mapped to host Unmapped Mapped to MAGs EHI01436 0.10323450 0.002155664 1.9223563 0.14057376 EHI01437 0.14688974 0.001776019 1.3951997 3.75777530 EHI01438 0.11341031 0.001443667 1.0781908 2.93324556 EHI01439 0.09710566 0.000553848 0.7633965 2.39854085 EHI01440 0.08161119 0.000412702 0.6588022 2.80294070 EHI01441 0.09842650 0.001532668 0.9259464 2.26467053 EHI01442 0.09044909 0.003948668 1.3099571 1.91223033 EHI01443 0.08349080 0.001670709 0.7703155 1.97118600 EHI01444 0.15356698 0.008828658 1.8761546 2.25276496 EHI01445 0.24321310 0.000493809 0.6808145 2.86800064 EHI01447 0.07308100 0.000928745 0.5335369 1.86430335 EHI01448 0.16654049 0.001447619 1.2343569 4.00302946 EHI01449 0.08086772 0.000712056 1.9015472 0.56772173 EHI01450 0.09513485 0.000808493 0.6801877 2.40271908 EHI01451 0.15486528 0.006054971 1.2002374 3.09457074 EHI01584 0.31311426 0.001124632 1.1945509 4.46459065 EHI01585 0.43461750 0.010705116 4.7173126 5.56319787 EHI01610 0.09609182 0.002231717 0.7319288 2.22137350 EHI01611 0.12854248 0.002113926 2.0768251 1.11056915 EHI01612 0.09445979 0.000396947 0.8434826 2.27477884 EHI01613 0.11771235 0.003535185 0.8236243 2.34411760 EHI01616 0.13311594 0.000846441 1.0689190 2.28105071 EHI01617 0.10496582 0.000600034 0.7624687 1.66612338 EHI01618 0.15796519 0.001938639 1.4700412 1.45306500 EHI01619 0.21423836 0.001610432 2.1137921 2.57152267 EHI01620 0.15125219 0.002882104 1.5452853 1.20720363 EHI01621 0.14437434 0.000908440 0.8938030 2.84473642 EHI01623 0.13905131 0.000111578 0.8158237 2.89356495 EHI01625 0.13457413 0.004361014 0.9973074 3.14405452 EHI01627 0.11510846 0.000652453 0.8491846 2.40277675 EHI01628 0.13073679 0.002521283 1.2403353 1.86084796 EHI01631 0.09932800 0.001705834 0.8044096 1.77531722 EHI02085 0.57919563 0.018462021 2.6410532 1.29059649 EHI02095 0.48834211 0.013513952 3.4049831 3.18378200 EHI02104 0.53195157 0.007010599 2.7354830 0.81316072 EHI02109 1.28374828 0.008847543 4.9223937 0.24490536 EHI02115 0.92901178 0.003428911 3.9141515 0.19065498 EHI02128 0.96743572 0.007418441 4.7627289 0.16898799 EHI02571 0.13287769 0.000830065 1.3326271 2.42337662 EHI02572 0.23097718 0.001104376 4.2180228 0.66197962 EHI02573 0.23772138 0.000919831 1.4201215 2.90177102 EHI02574 0.18641515 0.001105944 1.2909807 2.51445595 EHI02575 0.16800006 0.000451116 0.7701716 3.10908854 EHI02576 0.27054446 0.001466596 1.2373298 4.37179582 EHI02577 0.13875010 0.000159264 0.6656173 3.11920576 EHI02578 0.18840997 0.000370817 0.9281657 3.79342865 EHI02579 0.17040671 0.000316117 1.1304582 2.89912711 EHI02580 0.14585212 0.002285096 1.1005491 2.55888783 EHI02581 0.31534501 0.004222759 1.1406810 3.45948869 EHI02583 0.19024490 0.002688647 2.5186672 1.41498835 EHI02586 0.16808497 0.000634686 1.2191413 2.86012073 EHI02588 0.22724830 0.000620576 1.3616533 3.96253913 EHI02589 0.17868765 0.001172553 1.3032228 2.88262020 EHI02590 NA NA NA 0.01003195 EHI02591 0.24672078 0.005870858 5.1327559 0.11609000 EHI02593 0.28535188 0.001047289 1.7734727 3.51223396 EHI02594 0.14799113 0.001254245 2.2455458 0.78283346 EHI02595 0.17594927 0.000390443 0.8947388 2.65116816 EHI02596 0.19552510 0.000402096 0.8853602 3.90930111 EHI02597 0.16997179 0.003302624 1.8718822 2.27029869 EHI02599 0.24535794 0.002994709 1.6290468 3.25617683 EHI02600 0.16539330 0.000372951 2.5885522 0.78914504 EHI02601 0.20440033 0.000546487 1.2005389 3.29478799 EHI02604 0.13350290 0.000033019 0.5459000 2.24831357 EHI02605 0.23336073 0.000578456 0.7867636 4.00240210 EHI02606 0.21269906 0.000840830 0.9069484 4.52838330 EHI02608 0.16608092 0.000868246 1.2007537 2.21539480 EHI02609 0.18162303 0.000620091 1.2032065 3.45803993 EHI02610 0.18029349 0.000359149 1.0625221 3.04269811 EHI02611 0.14935861 0.000280047 0.9678059 2.31031466 EHI02613 0.13705908 0.001431597 0.6736314 2.75385288 EHI02614 0.18096790 0.000783821 1.1284081 2.27501989 EHI02616 0.14713007 0.000239190 0.5108695 2.35465880 EHI02618 0.17147141 0.000675857 0.9085123 2.63753628 EHI02620 0.15234767 0.000669926 0.8504433 2.26631084 EHI02621 0.18176981 0.000880545 2.0099358 2.33263631 EHI02622 0.20546598 0.000285185 1.1929782 3.39019490 EHI02623 0.14304619 0.000230072 0.5719310 2.72557253 EHI02626 0.20016240 0.000600853 0.9178175 2.61054132 EHI02627 0.16663385 0.001572916 2.4785902 0.65110510 EHI02628 0.14066292 0.000620136 0.5260281 1.86407529 EHI02629 0.15442873 0.001035638 1.3085973 2.62663840 EHI02631 0.28751065 0.003383238 4.2392404 1.34326512 EHI02634 0.27934868 0.001091891 2.4750414 3.24088595 EHI02635 0.30611130 0.001240215 1.3218018 4.73514062 EHI02636 0.33858819 0.000408731 1.2870087 6.26143207 EHI02637 0.25767107 0.000313024 1.3477516 5.69477117 EHI02638 0.26777696 0.001869868 1.9786471 3.30618562 EHI02640 0.20192954 0.002568987 1.1840044 3.29878050 EHI02641 0.53193661 0.006973676 3.8010965 4.56692336 EHI02642 0.35162886 0.000765507 5.4173877 1.45875812 EHI02643 0.33426863 0.001865962 5.7701855 1.11141741 EHI02646 0.35059944 0.008032777 6.5018324 1.15256692 sequence_fractions %&gt;% mutate_at(vars(-sample), ~./1000000000) %&gt;% rename(&quot;Sample&quot;=1, &quot;Low quality&quot;=2, &quot;Mapped to host&quot;=3, &quot;Unmapped&quot;=4, &quot;Mapped to MAGs&quot;=5) %&gt;% summarise(across(where(is.numeric), mean, na.rm = TRUE)) %&gt;% tt() tinytable_y3plx0tpgb2tw0xrhgvj .table td.tinytable_css_n1as9to0e2o50kgccp8w, .table th.tinytable_css_n1as9to0e2o50kgccp8w { border-bottom: solid 0.1em #d3d8dc; } Low quality Mapped to host Unmapped Mapped to MAGs 0.2261139 0.002232012 1.70865 2.507462 sequence_fractions %&gt;% pivot_longer(!sample, names_to = &quot;fraction&quot;, values_to = &quot;value&quot;) %&gt;% mutate(value = value / 1000000000) %&gt;% mutate(fraction = factor(fraction, levels = c(&quot;lowqual_bases&quot;,&quot;host_bases&quot;,&quot;unmapped_bases&quot;,&quot;mags_bases&quot;))) %&gt;% left_join(sample_metadata, by = join_by(sample == sample))%&gt;% ggplot(., aes(x = sample, y = value, fill=fraction)) + geom_bar(position=&quot;stack&quot;, stat = &quot;identity&quot;) + scale_fill_manual(name=&quot;Sequence type&quot;, breaks=c(&quot;lowqual_bases&quot;,&quot;host_bases&quot;,&quot;unmapped_bases&quot;,&quot;mags_bases&quot;), labels=c(&quot;Low quality&quot;,&quot;Mapped to host&quot;,&quot;Unmapped&quot;,&quot;Mapped to MAGs&quot;), values=c(&quot;#CCCCCC&quot;, &quot;#bcdee1&quot;, &quot;#d8b8a3&quot;,&quot;#93655c&quot;))+ facet_grid(~region, scales=&quot;free&quot;)+ labs(x = &quot;Samples&quot;, y = &quot;Amount of data (GB)&quot;) + theme_classic() + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1, size=6),legend.position = &quot;bottom&quot;) 3.3 Recovered microbial fraction singlem_table &lt;- sequence_fractions %&gt;% mutate(mags_proportion = round((mags_bases / (mags_bases + unmapped_bases))*100,2)) %&gt;% left_join(sample_metadata, by = join_by(sample == sample)) %&gt;% mutate(singlem_proportion = round(singlem_fraction*100,2)) %&gt;% dplyr::select(sample,mags_proportion,singlem_proportion) %&gt;% mutate(mags_proportion = ifelse(singlem_proportion == 0, 0, mags_proportion)) %&gt;% #convert zeros to NA mutate(singlem_proportion = ifelse(singlem_proportion == 0, NA, singlem_proportion)) %&gt;% #convert zeros to NA mutate(singlem_proportion = ifelse(singlem_proportion &lt; mags_proportion, NA, singlem_proportion)) %&gt;% #if singlem is smaller, then NA, to simplify plot mutate(singlem_proportion = ifelse(singlem_proportion &gt; 100, 100, singlem_proportion)) #simplify singlem_table %&gt;% pivot_longer(!sample, names_to = &quot;proportion&quot;, values_to = &quot;value&quot;) %&gt;% mutate(proportion = factor(proportion, levels = c(&quot;mags_proportion&quot;,&quot;singlem_proportion&quot;))) %&gt;% ggplot(., aes(x = value, y = sample, color=proportion)) + geom_line(aes(group = sample), color = &quot;#f8a538&quot;) + geom_point() + scale_color_manual(name=&quot;Proportion&quot;, breaks=c(&quot;mags_proportion&quot;,&quot;singlem_proportion&quot;), labels=c(&quot;Recovered&quot;,&quot;Estimated&quot;), values=c(&quot;#52e1e8&quot;, &quot;#876b53&quot;))+ theme_classic() + labs(y = &quot;Samples&quot;, x = &quot;Prokaryotic fraction (%)&quot;) + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1, size=6),legend.position = &quot;right&quot;) damr &lt;- singlem_table %&gt;% mutate(damr=ifelse(is.na(singlem_proportion),100,mags_proportion/singlem_proportion*100)) %&gt;% dplyr::select(sample,damr) damr %&gt;% tt() tinytable_t4dnwblogw1qedwz1kau .table td.tinytable_css_xjqbv7p4bj7b00fzuipu, .table th.tinytable_css_xjqbv7p4bj7b00fzuipu { border-bottom: solid 0.1em #d3d8dc; } sample damr EHI01436 14.498616 EHI01437 99.116488 EHI01438 98.837524 EHI01439 100.000000 EHI01440 100.000000 EHI01441 100.000000 EHI01442 95.602448 EHI01443 100.000000 EHI01444 95.853830 EHI01445 100.000000 EHI01447 94.747746 EHI01448 100.000000 EHI01449 39.258880 EHI01450 100.000000 EHI01451 100.000000 EHI01584 100.000000 EHI01585 100.000000 EHI01610 100.000000 EHI01611 59.100933 EHI01612 100.000000 EHI01613 100.000000 EHI01616 100.000000 EHI01617 100.000000 EHI01618 100.000000 EHI01619 100.000000 EHI01620 100.000000 EHI01621 100.000000 EHI01623 100.000000 EHI01625 100.000000 EHI01627 100.000000 EHI01628 100.000000 EHI01631 100.000000 EHI02085 100.000000 EHI02095 100.000000 EHI02104 46.583977 EHI02109 12.599681 EHI02115 8.541973 EHI02128 8.243211 EHI02571 100.000000 EHI02572 24.180328 EHI02573 100.000000 EHI02574 85.807038 EHI02575 100.000000 EHI02576 100.000000 EHI02577 100.000000 EHI02578 100.000000 EHI02579 100.000000 EHI02580 100.000000 EHI02581 100.000000 EHI02583 64.485479 EHI02586 100.000000 EHI02588 100.000000 EHI02589 100.000000 EHI02590 100.000000 EHI02591 79.211470 EHI02593 100.000000 EHI02594 48.390116 EHI02595 100.000000 EHI02596 100.000000 EHI02597 100.000000 EHI02599 100.000000 EHI02600 41.916383 EHI02601 100.000000 EHI02604 100.000000 EHI02605 100.000000 EHI02606 100.000000 EHI02608 100.000000 EHI02609 100.000000 EHI02610 100.000000 EHI02611 100.000000 EHI02613 100.000000 EHI02614 100.000000 EHI02616 100.000000 EHI02618 100.000000 EHI02620 100.000000 EHI02621 100.000000 EHI02622 100.000000 EHI02623 100.000000 EHI02626 100.000000 EHI02627 38.053421 EHI02628 100.000000 EHI02629 100.000000 EHI02631 42.964286 EHI02634 100.000000 EHI02635 100.000000 EHI02636 100.000000 EHI02637 100.000000 EHI02638 93.150685 EHI02640 100.000000 EHI02641 98.715862 EHI02642 36.752729 EHI02643 49.328039 EHI02646 28.060369 damr %&gt;% filter(damr&gt;95) %&gt;% nrow() [1] 73 damr %&gt;% summarise(mean=mean(damr),sd=sd(damr)) %&gt;% tt() tinytable_42dv8vuue3u66anfe7jc .table td.tinytable_css_4ywmczicssz5l8dyawqm, .table th.tinytable_css_4ywmczicssz5l8dyawqm { border-bottom: solid 0.1em #d3d8dc; } mean sd 88.21507 25.46559 samples_50damr &lt;- damr %&gt;% filter(damr&gt;50) %&gt;% select(sample) 3.3.1 Samples discarded (damr &lt; 80) samples_lowdamr &lt;- damr %&gt;% filter(damr&lt;80) %&gt;% select(sample) sample_metadata[sample_metadata$sample %in% samples_lowdamr$sample,] %&gt;% count(region, type, season, sort = TRUE) # A tibble: 8 × 4 region type season n &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;int&gt; 1 Irun natural autumn 6 2 Aia protected autumn 3 3 Orio urban autumn 2 4 Usurbil natural spring 2 5 Usurbil natural autumn 1 6 Villabona natural autumn 1 7 Zarautz protected autumn 1 8 Zarautz protected spring 1 sample_metadata[!sample_metadata$sample %in% samples_lowdamr$sample,] %&gt;% count(region, type, season,sort = TRUE) sample_metadata_filtdamr &lt;- sample_metadata[!sample_metadata$sample %in% samples_lowdamr$sample,] genome_counts_filtdamr &lt;- genome_counts_filt %&gt;% select(c(&quot;genome&quot;,sample_metadata_filtdamr$sample))%&gt;% filter(rowSums(across(where(is.numeric)))!=0) genome_metadata_filtdamr &lt;- genome_metadata %&gt;% semi_join(., genome_counts_filtdamr, by = &quot;genome&quot;) %&gt;% arrange(match(genome,genome_counts_filtdamr$genome)) genome_metadata_removed &lt;- genome_metadata %&gt;% anti_join(., genome_counts_filtdamr, by = &quot;genome&quot;) %&gt;% arrange(match(genome,genome_counts_filtdamr$genome)) genome_tree_filtdamr &lt;- keep.tip(genome_tree, tip=genome_metadata_filtdamr$genome) genome_counts_filt_func &lt;- genome_counts_filt[genome_counts_filt$genome %in% rownames(genome_gifts),] genome_gifts_filtdamr &lt;- genome_gifts[rownames(genome_gifts) %in% genome_counts_filtdamr$genome,] genome_gifts_filtdamr &lt;- genome_gifts_filtdamr[, colSums(genome_gifts_filtdamr != 0) &gt; 0] phylum_colors_filtdamr &lt;- read_tsv(&quot;https://raw.githubusercontent.com/earthhologenome/EHI_taxonomy_colour/main/ehi_phylum_colors.tsv&quot;) %&gt;% right_join(genome_metadata_filtdamr, by=join_by(phylum == phylum)) %&gt;% arrange(match(genome, genome_tree_filtdamr$tip.label)) %&gt;% select(phylum, colors) %&gt;% unique() %&gt;% arrange(phylum) %&gt;% pull(colors, name=phylum) save(sample_metadata_filtdamr, genome_counts_filtdamr, genome_metadata_filtdamr, genome_tree_filtdamr, genome_gifts_filtdamr, phylum_colors_filtdamr, location_colors, type_colors, file = &quot;data/data_filtdamr_80.Rdata&quot; ) "],["mag-catalogue.html", "Chapter 4 MAG catalogue 4.1 Genome phylogeny 4.2 Taxonomy overview 4.3 Genome quality 4.4 Functional overview 4.5 Functional ordination", " Chapter 4 MAG catalogue load(&quot;data/data.Rdata&quot;) 4.1 Genome phylogeny # Generate the phylum color heatmap phylum_heatmap &lt;- read_tsv(&quot;https://raw.githubusercontent.com/earthhologenome/EHI_taxonomy_colour/main/ehi_phylum_colors.tsv&quot;) %&gt;% right_join(genome_metadata, by=join_by(phylum == phylum)) %&gt;% arrange(match(genome, genome_tree$tip.label)) %&gt;% dplyr::select(genome,phylum) %&gt;% mutate(phylum = factor(phylum, levels = unique(phylum))) %&gt;% column_to_rownames(var = &quot;genome&quot;) # Generate basal tree circular_tree &lt;- force.ultrametric(genome_tree, method=&quot;extend&quot;) %&gt;% # extend to ultrametric for the sake of visualisation ggtree(., layout=&quot;fan&quot;, open.angle=10, size=0.5) *************************************************************** * Note: * * force.ultrametric does not include a formal method to * * ultrametricize a tree &amp; should only be used to coerce * * a phylogeny that fails is.ultrametric due to rounding -- * * not as a substitute for formal rate-smoothing methods. * *************************************************************** # Add phylum ring circular_tree &lt;- gheatmap(circular_tree, phylum_heatmap, offset=0.55, width=0.1, colnames=FALSE) + scale_fill_manual(values=phylum_colors) + geom_tiplab2(size=1, hjust=-0.1) + theme(legend.position = &quot;none&quot;, plot.margin = margin(0, 0, 0, 0), panel.margin = margin(0, 0, 0, 0)) # Flush color scale to enable a new color scheme in the next ring circular_tree &lt;- circular_tree + new_scale_fill() # Add completeness ring circular_tree &lt;- circular_tree + new_scale_fill() + scale_fill_gradient(low = &quot;#d1f4ba&quot;, high = &quot;#f4baba&quot;) + geom_fruit( data=genome_metadata, geom=geom_bar, mapping = aes(x=completeness, y=genome, fill=contamination), offset = 0.55, orientation=&quot;y&quot;, stat=&quot;identity&quot;) # Add genome-size ring circular_tree &lt;- circular_tree + new_scale_fill() + scale_fill_manual(values = &quot;#cccccc&quot;) + geom_fruit( data=genome_metadata, geom=geom_bar, mapping = aes(x=length, y=genome), offset = 0.05, orientation=&quot;y&quot;, stat=&quot;identity&quot;) # Add text circular_tree &lt;- circular_tree + annotate(&#39;text&#39;, x=3.5, y=0, label=&#39; Phylum&#39;, family=&#39;arial&#39;, size=3.5) + annotate(&#39;text&#39;, x=4.5, y=0, label=&#39; Genome quality&#39;, family=&#39;arial&#39;, size=3.5) + annotate(&#39;text&#39;, x=5.0, y=0, label=&#39; Genome size&#39;, family=&#39;arial&#39;, size=3.5) #Plot circular tree circular_tree %&gt;% open_tree(30) %&gt;% rotate_tree(90) 4.2 Taxonomy overview Number of MAGs 1034 Domains genome_metadata %&gt;% group_by(domain) %&gt;% summarise(mag_n=n()) %&gt;% arrange(-mag_n) %&gt;% tt() tinytable_blujn04gjipnisj3pnyh .table td.tinytable_css_5dgnqwsbzrma5r9jd9yq, .table th.tinytable_css_5dgnqwsbzrma5r9jd9yq { border-bottom: solid 0.1em #d3d8dc; } domain mag_n d__Bacteria 1025 d__Archaea 9 Archaea genome_metadata %&gt;% filter(domain == &quot;d__Archaea&quot;) %&gt;% group_by(phylum) %&gt;% summarise(mag_n=n()) %&gt;% arrange(-mag_n) %&gt;% tt() tinytable_s6u7cufwnlr7um83ef74 .table td.tinytable_css_a86rxmnh9burh5bmro00, .table th.tinytable_css_a86rxmnh9burh5bmro00 { border-bottom: solid 0.1em #d3d8dc; } phylum mag_n p__Halobacteriota 4 p__Thermoproteota 2 p__Iainarchaeota 1 p__Methanobacteriota 1 p__Nanoarchaeota 1 Bacteria genome_metadata %&gt;% filter(domain == &quot;d__Bacteria&quot;) %&gt;% group_by(phylum) %&gt;% summarise(mag_n=n()) %&gt;% arrange(-mag_n) %&gt;% tt() tinytable_7pyiup478exc2jcprw5m .table td.tinytable_css_y94z0exnvmrcoh3dwmmp, .table th.tinytable_css_y94z0exnvmrcoh3dwmmp { border-bottom: solid 0.1em #d3d8dc; } phylum mag_n p__Bacteroidota 369 p__Bacillota_A 251 p__Pseudomonadota 156 p__Bacillota 54 p__Desulfobacterota 37 p__Verrucomicrobiota 29 p__Patescibacteria 27 p__Cyanobacteriota 23 p__Fusobacteriota 12 p__Chloroflexota 10 p__Bacillota_C 9 p__Deferribacterota 8 p__Acidobacteriota 6 p__Bacillota_B 5 p__Desulfobacterota_F 5 p__Actinomycetota 4 p__Planctomycetota 4 p__Spirochaetota 4 p__Campylobacterota 3 p__Myxococcota 2 p__ 1 p__Chlamydiota 1 p__Desulfobacterota_G 1 p__Fibrobacterota 1 p__J088 1 p__JAKLEM01 1 p__Omnitrophota 1 Number of MAGs without phyla-level annotation 1 Number of MAGs without class-level annotation 2 # A tibble: 1 × 2 completeness contamination &lt;dbl&gt; &lt;dbl&gt; 1 57.6 2.37 Number of MAGs without order-level annotation 4 # A tibble: 1 × 2 completeness contamination &lt;dbl&gt; &lt;dbl&gt; 1 76.2 1.21 Number of MAGs without family-level annotation 32 # A tibble: 1 × 2 completeness contamination &lt;dbl&gt; &lt;dbl&gt; 1 83.1 1.97 Number of MAGs without genus-level annotation 276 # A tibble: 1 × 2 completeness contamination &lt;dbl&gt; &lt;dbl&gt; 1 83.8 1.60 Percentage of MAGs without genera-level annotation 26.69246 Number of MAGs without species-level annotation 978 Percentage of MAGs without species-level annotation 94.58414 Number of MAGs with species-level annotation 56 4.2.1 MAGs shared across locations 4.3 Genome quality 4.3.1 Mean completeness and contamination genome_metadata %&gt;% summarise(completeness_mean=mean(completeness) %&gt;% round(2) %&gt;% as.character(), completeness_sd=sd(completeness) %&gt;% round(2) %&gt;% as.character(), contamination_mean=mean(contamination) %&gt;% round(2), contamination_sd=sd(contamination) %&gt;% round(2)) %&gt;% unite(&quot;Completeness&quot;,completeness_mean, completeness_sd, sep = &quot; ± &quot;, remove = TRUE) %&gt;% unite(&quot;Contamination&quot;,contamination_mean, contamination_sd, sep = &quot; ± &quot;, remove = TRUE) %&gt;% tt() tinytable_4vbdyf6fcedfplexybrf .table td.tinytable_css_eb0ml4qk7ow1l690uirl, .table th.tinytable_css_eb0ml4qk7ow1l690uirl { border-bottom: solid 0.1em #d3d8dc; } Completeness Contamination 82.77 ± 17.28 1.91 ± 2.36 4.3.2 Medium-quality Mags (&gt;70% completeness, &lt;10% contamination) genome_metadata %&gt;% filter(completeness &gt;=70 &amp; contamination &lt;=10) %&gt;% nrow() [1] 750 4.3.3 High-quality Mags (&gt;95% completeness, &lt;5% contamination) genome_metadata %&gt;% filter(completeness &gt;=95 &amp; contamination &lt;=5) %&gt;% nrow() [1] 404 #Generate quality biplot genome_biplot &lt;- genome_metadata %&gt;% dplyr::select(c(genome,domain,phylum,completeness,contamination,length)) %&gt;% arrange(match(genome, rev(genome_tree$tip.label))) %&gt;% #sort MAGs according to phylogenetic tree ggplot(aes(x=completeness,y=contamination,size=length,color=phylum)) + geom_point(alpha=0.7) + ylim(c(10,0)) + scale_color_manual(values=phylum_colors) + labs(y= &quot;Contamination&quot;, x = &quot;Completeness&quot;) + theme_classic() + theme(legend.position = &quot;none&quot;) #Generate contamination boxplot genome_contamination &lt;- genome_metadata %&gt;% ggplot(aes(y=contamination)) + ylim(c(10,0)) + geom_boxplot(colour = &quot;#999999&quot;, fill=&quot;#cccccc&quot;) + theme_void() + theme(legend.position = &quot;none&quot;, axis.title.x = element_blank(), axis.title.y = element_blank(), axis.text.y=element_blank(), axis.ticks.y=element_blank(), axis.text.x=element_blank(), axis.ticks.x=element_blank(), plot.margin = unit(c(0, 0, 0.40, 0),&quot;inches&quot;)) #add bottom-margin (top, right, bottom, left) #Generate completeness boxplot genome_completeness &lt;- genome_metadata %&gt;% ggplot(aes(x=completeness)) + xlim(c(50,100)) + geom_boxplot(colour = &quot;#999999&quot;, fill=&quot;#cccccc&quot;) + theme_void() + theme(legend.position = &quot;none&quot;, axis.title.x = element_blank(), axis.title.y = element_blank(), axis.text.y=element_blank(), axis.ticks.y=element_blank(), axis.text.x=element_blank(), axis.ticks.x=element_blank(), plot.margin = unit(c(0, 0, 0, 0.50),&quot;inches&quot;)) #add left-margin (top, right, bottom, left) #Render composite figure grid.arrange(grobs = list(genome_completeness,genome_biplot,genome_contamination), layout_matrix = rbind(c(1,1,1,1,1,1,1,1,1,1,1,4), c(2,2,2,2,2,2,2,2,2,2,2,3), c(2,2,2,2,2,2,2,2,2,2,2,3), c(2,2,2,2,2,2,2,2,2,2,2,3), c(2,2,2,2,2,2,2,2,2,2,2,3), c(2,2,2,2,2,2,2,2,2,2,2,3), c(2,2,2,2,2,2,2,2,2,2,2,3), c(2,2,2,2,2,2,2,2,2,2,2,3), c(2,2,2,2,2,2,2,2,2,2,2,3), c(2,2,2,2,2,2,2,2,2,2,2,3), c(2,2,2,2,2,2,2,2,2,2,2,3), c(2,2,2,2,2,2,2,2,2,2,2,3))) 4.4 Functional overview # Aggregate basal GIFT into elements function_table &lt;- genome_gifts %&gt;% to.elements(., GIFT_db) # Generate basal tree function_tree &lt;- force.ultrametric(genome_tree, method=&quot;extend&quot;) %&gt;% ggtree(., size = 0.3) *************************************************************** * Note: * * force.ultrametric does not include a formal method to * * ultrametricize a tree &amp; should only be used to coerce * * a phylogeny that fails is.ultrametric due to rounding -- * * not as a substitute for formal rate-smoothing methods. * *************************************************************** #Add phylum colors next to the tree tips function_tree &lt;- gheatmap(function_tree, phylum_heatmap, offset=0, width=0.1, colnames=FALSE) + scale_fill_manual(values=phylum_colors) + labs(fill=&quot;Phylum&quot;) #Reset fill scale to use a different colour profile in the heatmap function_tree &lt;- function_tree + new_scale_fill() #Add functions heatmap function_tree &lt;- gheatmap(function_tree, function_table, offset=0.5, width=3.5, colnames=FALSE) + vexpand(.08) + coord_cartesian(clip = &quot;off&quot;) + scale_fill_gradient(low = &quot;#f4f4f4&quot;, high = &quot;steelblue&quot;, na.value=&quot;white&quot;) + labs(fill=&quot;GIFT&quot;) #Reset fill scale to use a different colour profile in the heatmap function_tree &lt;- function_tree + new_scale_fill() # Add completeness barplots function_tree &lt;- function_tree + geom_fruit(data=genome_metadata, geom=geom_bar, grid.params=list(axis=&quot;x&quot;, text.size=2, nbreak = 1), axis.params=list(vline=TRUE), mapping = aes(x=length, y=genome, fill=completeness), offset = 3.8, orientation=&quot;y&quot;, stat=&quot;identity&quot;) + scale_fill_gradient(low = &quot;#cf8888&quot;, high = &quot;#a2cc87&quot;) + labs(fill=&quot;Genome\\ncompleteness&quot;) function_tree 4.5 Functional ordination # Generate the tSNE ordination tSNE_function &lt;- Rtsne(X=function_table, dims = 2, check_duplicates = FALSE) # Plot the ordination function_ordination &lt;- tSNE_function$Y %&gt;% as.data.frame() %&gt;% mutate(genome=rownames(function_table)) %&gt;% inner_join(genome_metadata, by=&quot;genome&quot;) %&gt;% rename(tSNE1=&quot;V1&quot;, tSNE2=&quot;V2&quot;) %&gt;% dplyr::select(genome,phylum,tSNE1,tSNE2, length) %&gt;% ggplot(aes(x = tSNE1, y = tSNE2, color = phylum, size=length))+ geom_point(shape=16, alpha=0.7) + scale_color_manual(values=phylum_colors) + theme_minimal() + labs(color=&quot;Phylum&quot;, size=&quot;Genome size&quot;) + guides(color = guide_legend(override.aes = list(size = 5))) # enlarge Phylum dots in legend function_ordination "],["community-composition.html", "Chapter 5 Community composition 5.1 Taxonomy overview 5.2 Phylum relative abundances 5.3 Family relative abundances 5.4 Genus relative abundances 5.5 Archaea", " Chapter 5 Community composition load(&quot;data/data.Rdata&quot;) 5.1 Taxonomy overview Mean percentage of Bacteria and Archaea in the samples domain_summary &lt;- genome_counts_filt %&gt;% mutate_at(vars(-genome),~./sum(.)) %&gt;% #apply TSS normalisation pivot_longer(-genome, names_to = &quot;sample&quot;, values_to = &quot;count&quot;) %&gt;% left_join(sample_metadata, by = join_by(sample == sample)) %&gt;% left_join(genome_metadata, by = join_by(genome == genome)) %&gt;% group_by(sample,domain) %&gt;% summarise(relabun=sum(count)) domain_summary %&gt;% group_by(domain) %&gt;% summarise(mean=mean(relabun, na.rm=T)*100,sd=sd(relabun, na.rm=T)*100) %&gt;% arrange(-mean) %&gt;% tt() tinytable_plryz9le47mjhq9ly36n .table td.tinytable_css_jw7onhz7041iglhf1hxy, .table th.tinytable_css_jw7onhz7041iglhf1hxy { border-bottom: solid 0.1em #d3d8dc; } domain mean sd d__Bacteria 99.5141306 1.71795 d__Archaea 0.4858694 1.71795 #ggsave(&quot;figures/mtcars.png&quot;, width = 10, height = 6) genome_counts_filt %&gt;% mutate_at(vars(-genome),~./sum(.)) %&gt;% #apply TSS normalisation pivot_longer(-genome, names_to = &quot;sample&quot;, values_to = &quot;count&quot;) %&gt;% #reduce to minimum number of columns left_join(., genome_metadata, by = join_by(genome == genome)) %&gt;% #append genome metadata left_join(., sample_metadata, by = join_by(sample == sample)) %&gt;% #append sample metadata filter(count &gt; 0) %&gt;% #filter 0 counts # filter(!region %in% c(&quot;Eskoriatza&quot;,&quot;Villabona&quot;)) %&gt;% mutate(season=factor(season,levels=c(&quot;spring&quot;,&quot;autumn&quot;))) %&gt;% ggplot(., aes(x=sample,y=count, fill=phylum, group=phylum)) + #grouping enables keeping the same sorting of taxonomic units geom_bar(stat=&quot;identity&quot;, colour=&quot;white&quot;, linewidth=0.1, show.legend = FALSE) + #plot stacked bars with white borders scale_fill_manual(values=phylum_colors) + facet_nested(. ~ type + region+season, scales=&quot;free&quot;) + #facet per day and treatment guides(fill = guide_legend(ncol = 2)) + theme(axis.text.x = element_blank(), axis.ticks.x = element_blank(), axis.title.x = element_blank(), panel.background = element_blank(), panel.grid.major = element_blank(), panel.grid.minor = element_blank(), axis.line = element_line(linewidth = 0.5, linetype = &quot;solid&quot;, colour = &quot;black&quot;), panel.border = element_rect(colour = &quot;black&quot;, fill = NA), strip.background = element_rect(fill = &quot;white&quot;, color = &quot;black&quot;), strip.text = element_text(size = 8, lineheight = 0.6)) + labs(fill=&quot;Phylum&quot;,y = &quot;Relative abundance&quot;,x=&quot;Samples&quot;) Number of bacteria phyla [1] 27 Bacteria phyla in natural ponds phylum EHA02325_bin.10 p__Bacillota_A EHA02325_bin.13 p__Pseudomonadota EHA02325_bin.39 p__Bacteroidota EHA02329_bin.18 p__Verrucomicrobiota EHA02330_bin.9 p__Cyanobacteriota EHA02331_bin.2 p__Bacillota EHA02336_bin.41 p__Bacillota_C EHA02338_bin.7 p__Desulfobacterota EHA02341_bin.14 p__Spirochaetota EHA02343_bin.12 p__Acidobacteriota EHA02355_bin.3 p__Bacillota_B EHA02388_bin.85 p__Deferribacterota EHA02392_bin.43 p__Chloroflexota EHA02398_bin.48 p__Fusobacteriota EHA02398_bin.53 p__Campylobacterota EHA04294_bin.16 p__Desulfobacterota_F EHA04302_bin.12 p__Patescibacteria EHA04302_bin.18 p__J088 EHA04321_bin.47 p__Planctomycetota EHA04321_bin.50 p__Omnitrophota EHA04321_bin.55 p__Chlamydiota EHA04321_bin.69 p__Actinomycetota EHA04337_bin.58 p__Desulfobacterota_G EHA04343_bin.186 p__ Bacteria phyla in protected ponds phylum EHA02325_bin.10 p__Bacillota_A EHA02325_bin.13 p__Pseudomonadota EHA02325_bin.19 p__Bacteroidota EHA02329_bin.18 p__Verrucomicrobiota EHA02330_bin.9 p__Cyanobacteriota EHA02331_bin.2 p__Bacillota EHA02336_bin.41 p__Bacillota_C EHA02338_bin.7 p__Desulfobacterota EHA02355_bin.3 p__Bacillota_B EHA02374_bin.97 p__Fusobacteriota EHA02388_bin.64 p__Chloroflexota EHA02388_bin.85 p__Deferribacterota EHA04305_bin.59 p__Spirochaetota EHA04352_bin.62 p__Campylobacterota Bacteria phyla in urban ponds phylum EHA02325_bin.10 p__Bacillota_A EHA02325_bin.13 p__Pseudomonadota EHA02325_bin.39 p__Bacteroidota EHA02329_bin.18 p__Verrucomicrobiota EHA02331_bin.2 p__Bacillota EHA02336_bin.41 p__Bacillota_C EHA02338_bin.7 p__Desulfobacterota EHA02340_bin.1 p__Cyanobacteriota EHA02341_bin.14 p__Spirochaetota EHA02341_bin.28 p__Fusobacteriota EHA02355_bin.3 p__Bacillota_B EHA02378_bin.75 p__Deferribacterota EHA02398_bin.53 p__Campylobacterota EHA04304_bin.13 p__JAKLEM01 EHA04304_bin.1 p__Patescibacteria EHA04304_bin.21 p__Chloroflexota EHA04321_bin.69 p__Actinomycetota EHA04337_bin.116 p__Acidobacteriota EHA04337_bin.35 p__Fibrobacterota EHA04337_bin.58 p__Desulfobacterota_G EHA04337_bin.88 p__Myxococcota EHA04343_bin.186 p__ Number of Archaea phyla [1] 5 Archaea phyla in natural ponds phylum EHA02392_bin.10 p__Methanobacteriota EHA04302_bin.11 p__Nanoarchaeota EHA04304_bin.19 p__Halobacteriota EHA04321_bin.111 p__Iainarchaeota EHA04343_bin.4 p__Thermoproteota Archaea phyla in protected ponds phylum EHA04312_bin.192 p__Halobacteriota EHA04352_bin.100 p__Thermoproteota Archaea phyla in urban ponds phylum EHA02392_bin.10 p__Methanobacteriota EHA04304_bin.19 p__Halobacteriota 5.2 Phylum relative abundances phylum_summary &lt;- genome_counts_filt %&gt;% mutate_at(vars(-genome),~./sum(.)) %&gt;% #apply TSS nornalisation pivot_longer(-genome, names_to = &quot;sample&quot;, values_to = &quot;count&quot;) %&gt;% left_join(sample_metadata, by = join_by(sample == sample)) %&gt;% left_join(genome_metadata, by = join_by(genome == genome)) %&gt;% group_by(sample,phylum,type, season) %&gt;% summarise(relabun=sum(count)) phylum_summary %&gt;% group_by(phylum) %&gt;% summarise(total_mean=mean(relabun*100, na.rm=T), total_sd=sd(relabun*100, na.rm=T)) %&gt;% mutate(total=str_c(round(total_mean,2),&quot;±&quot;,round(total_sd,2))) %&gt;% arrange(-total_mean) %&gt;% dplyr::select(phylum,total) %&gt;% tt() tinytable_anx4pbv3l3elxsx5t787 .table td.tinytable_css_7lkxmhk5fu6u6fbnsgll, .table th.tinytable_css_7lkxmhk5fu6u6fbnsgll { border-bottom: solid 0.1em #d3d8dc; } phylum total p__Bacteroidota 53.53±20.47 p__Bacillota_A 15.07±11.48 p__Pseudomonadota 13.1±18.44 p__Bacillota 5.62±7.54 p__Verrucomicrobiota 4.16±5.07 p__Desulfobacterota 2.11±2.92 p__Cyanobacteriota 1.4±6.77 p__Chloroflexota 1.04±3.88 p__Fusobacteriota 0.52±1.23 p__Myxococcota 0.5±4.84 p__Bacillota_C 0.47±0.77 p__Patescibacteria 0.37±1.58 p__Acidobacteriota 0.34±1.44 p__Deferribacterota 0.31±0.9 p__Bacillota_B 0.24±0.36 p__Desulfobacterota_F 0.23±1.04 p__Halobacteriota 0.21±1.41 p__Planctomycetota 0.17±1.16 p__Thermoproteota 0.15±0.55 p__Nanoarchaeota 0.07±0.65 p__Spirochaetota 0.07±0.31 p__Campylobacterota 0.06±0.3 p__Methanobacteriota 0.04±0.28 p__Actinomycetota 0.04±0.2 p__Fibrobacterota 0.04±0.35 p__ 0.04±0.29 p__Chlamydiota 0.03±0.14 p__Desulfobacterota_G 0.03±0.2 p__J088 0.02±0.11 p__Iainarchaeota 0.01±0.1 p__JAKLEM01 0.01±0.11 p__Omnitrophota 0.01±0.05 phylum_arrange &lt;- phylum_summary %&gt;% group_by(phylum) %&gt;% summarise(mean=mean(relabun)) %&gt;% arrange(-mean) %&gt;% dplyr::select(phylum) %&gt;% pull() phylum_summary %&gt;% filter(phylum %in% phylum_arrange) %&gt;% mutate(phylum=factor(phylum,levels=rev(phylum_arrange))) %&gt;% ggplot(aes(x=relabun, y=phylum, group=phylum, color=phylum)) + scale_color_manual(values=phylum_colors[rev(phylum_arrange)]) + geom_jitter(alpha=0.5, show.legend = FALSE) + theme_minimal() + theme(legend.position=&quot;none&quot;) + labs(y=&quot;Phylum&quot;,x=&quot;Relative abundance&quot;) 5.2.1 Per pond phylum_summary %&gt;% group_by(phylum) %&gt;% summarise(total_mean=mean(relabun*100, na.rm=T), total_sd=sd(relabun*100, na.rm=T), natural_mean=mean(relabun[type==&quot;natural&quot;]*100, na.rm=T), natural_sd=sd(relabun[type==&quot;natural&quot;]*100, na.rm=T), protected_mean=mean(relabun[type==&quot;protected&quot;]*100, na.rm=T), protected_sd=sd(relabun[type==&quot;protected&quot;]*100, na.rm=T), urban_mean=mean(relabun[type==&quot;urban&quot;]*100, na.rm=T), urban_sd=sd(relabun[type==&quot;urban&quot;]*100, na.rm=T)) %&gt;% mutate(total=str_c(round(total_mean,2),&quot;±&quot;,round(total_sd,2)), natural=str_c(round(natural_mean,2),&quot;±&quot;,round(natural_sd,2)), protected=str_c(round(protected_mean,2),&quot;±&quot;,round(protected_sd,2)), urban=str_c(round(urban_mean,2),&quot;±&quot;,round(urban_sd,2))) %&gt;% arrange(-total_mean) %&gt;% dplyr::select(phylum,total,natural,protected,urban) %&gt;% tt() tinytable_u2r87h8sk3jxgx7nxzl4 .table td.tinytable_css_7ivwzm2asphgmk8dsdb0, .table th.tinytable_css_7ivwzm2asphgmk8dsdb0 { border-bottom: solid 0.1em #d3d8dc; } phylum total natural protected urban p__Bacteroidota 53.53±20.47 50.72±21.6 57.47±21.28 53.47±17.18 p__Bacillota_A 15.07±11.48 11.93±9.38 19.02±15.51 15.52±6.64 p__Pseudomonadota 13.1±18.44 15.4±21.12 11.62±18.14 10.95±13.43 p__Bacillota 5.62±7.54 7.41±9.62 3.76±4.74 4.85±5.6 p__Verrucomicrobiota 4.16±5.07 5.14±5.61 3.09±4.44 3.82±4.69 p__Desulfobacterota 2.11±2.92 1.51±1.68 1.51±1.92 3.91±4.59 p__Cyanobacteriota 1.4±6.77 2.03±9.69 1.08±4.04 0.69±0.83 p__Chloroflexota 1.04±3.88 1.23±2.97 0.69±3.69 1.13±5.38 p__Fusobacteriota 0.52±1.23 0.26±0.51 0.45±1.36 1.05±1.74 p__Myxococcota 0.5±4.84 0±0 0±0 2.02±9.68 p__Bacillota_C 0.47±0.77 0.39±0.72 0.71±1.04 0.31±0.27 p__Patescibacteria 0.37±1.58 0.81±2.31 0±0 0.1±0.46 p__Acidobacteriota 0.34±1.44 0.58±2 0±0 0.33±1.11 p__Deferribacterota 0.31±0.9 0.52±1.33 0.12±0.21 0.17±0.24 p__Bacillota_B 0.24±0.36 0.08±0.22 0.32±0.31 0.43±0.48 p__Desulfobacterota_F 0.23±1.04 0.53±1.54 0±0 0±0 p__Halobacteriota 0.21±1.41 0.09±0.27 0.04±0.18 0.62±2.8 p__Planctomycetota 0.17±1.16 0.39±1.75 0±0 0±0 p__Thermoproteota 0.15±0.55 0.28±0.78 0.1±0.29 0±0 p__Nanoarchaeota 0.07±0.65 0.17±0.99 0±0 0±0 p__Spirochaetota 0.07±0.31 0.02±0.07 0.02±0.09 0.24±0.59 p__Campylobacterota 0.06±0.3 0.1±0.43 0.01±0.03 0.07±0.22 p__Methanobacteriota 0.04±0.28 0.09±0.42 0±0 0.01±0.05 p__Actinomycetota 0.04±0.2 0.08±0.3 0±0 0.01±0.02 p__Fibrobacterota 0.04±0.35 0±0 0±0 0.14±0.69 p__ 0.04±0.29 0.07±0.44 0±0 0.02±0.09 p__Chlamydiota 0.03±0.14 0.06±0.21 0±0 0±0 p__Desulfobacterota_G 0.03±0.2 0.01±0.08 0±0 0.08±0.39 p__J088 0.02±0.11 0.05±0.17 0±0 0±0 p__Iainarchaeota 0.01±0.1 0.03±0.15 0±0 0±0 p__JAKLEM01 0.01±0.11 0±0 0±0 0.05±0.22 p__Omnitrophota 0.01±0.05 0.02±0.07 0±0 0±0 phylum_summary %&gt;% filter(phylum %in% phylum_arrange) %&gt;% mutate(phylum=factor(phylum,levels=rev(phylum_arrange))) %&gt;% filter(relabun &gt; 0) %&gt;% ggplot(aes(x=relabun, y=phylum, group=phylum, color=phylum)) + scale_color_manual(values=phylum_colors[-8]) + geom_jitter(alpha=0.5, show.legend = FALSE) + facet_grid(.~type)+ theme_minimal() + labs(y=&quot;Family&quot;, x=&quot;Relative abundance&quot;, color=&quot;Phylum&quot;) 5.2.2 Per season phylum_summary %&gt;% group_by(phylum) %&gt;% summarise(total_mean=mean(relabun*100, na.rm=T), total_sd=sd(relabun*100, na.rm=T), spring_mean=mean(relabun[season==&quot;spring&quot;]*100, na.rm=T), spring_sd=sd(relabun[season==&quot;spring&quot;]*100, na.rm=T), autumn_mean=mean(relabun[season==&quot;autumn&quot;]*100, na.rm=T), autumn_sd=sd(relabun[season==&quot;autumn&quot;]*100, na.rm=T)) %&gt;% mutate(total=str_c(round(total_mean,2),&quot;±&quot;,round(total_sd,2)), spring=str_c(round(spring_mean,2),&quot;±&quot;,round(spring_sd,2)), autumn=str_c(round(autumn_mean,2),&quot;±&quot;,round(autumn_sd,2))) %&gt;% arrange(-total_mean) %&gt;% dplyr::select(phylum,total,spring,autumn) %&gt;% tt() tinytable_tljtsbu77nrxamh7bh5a .table td.tinytable_css_fibjyvkjxglqw4od7jzn, .table th.tinytable_css_fibjyvkjxglqw4od7jzn { border-bottom: solid 0.1em #d3d8dc; } phylum total spring autumn p__Bacteroidota 53.53±20.47 49.04±16.42 55.93±22.09 p__Bacillota_A 15.07±11.48 17.89±9.58 13.56±12.18 p__Pseudomonadota 13.1±18.44 15.38±16.87 11.89±19.25 p__Bacillota 5.62±7.54 5.54±5.29 5.66±8.54 p__Verrucomicrobiota 4.16±5.07 5.09±5.05 3.67±5.05 p__Desulfobacterota 2.11±2.92 2.64±2.09 1.83±3.26 p__Cyanobacteriota 1.4±6.77 1.34±3.83 1.43±7.93 p__Chloroflexota 1.04±3.88 1.11±4.11 1±3.78 p__Fusobacteriota 0.52±1.23 0.31±0.53 0.62±1.47 p__Myxococcota 0.5±4.84 0±0 0.77±6 p__Bacillota_C 0.47±0.77 0.43±0.77 0.49±0.78 p__Patescibacteria 0.37±1.58 0±0 0.57±1.93 p__Acidobacteriota 0.34±1.44 0.39±1.58 0.31±1.37 p__Deferribacterota 0.31±0.9 0.21±0.23 0.36±1.11 p__Bacillota_B 0.24±0.36 0.29±0.34 0.22±0.37 p__Desulfobacterota_F 0.23±1.04 0.08±0.37 0.31±1.26 p__Halobacteriota 0.21±1.41 0.02±0.05 0.31±1.75 p__Planctomycetota 0.17±1.16 0±0 0.26±1.44 p__Thermoproteota 0.15±0.55 0.06±0.25 0.2±0.65 p__Nanoarchaeota 0.07±0.65 0±0 0.11±0.81 p__Spirochaetota 0.07±0.31 0.13±0.43 0.04±0.22 p__Campylobacterota 0.06±0.3 0.04±0.13 0.08±0.36 p__Methanobacteriota 0.04±0.28 0.03±0.11 0.05±0.34 p__Actinomycetota 0.04±0.2 0±0 0.06±0.24 p__Fibrobacterota 0.04±0.35 0±0 0.06±0.43 p__ 0.04±0.29 0±0 0.05±0.36 p__Chlamydiota 0.03±0.14 0±0 0.04±0.18 p__Desulfobacterota_G 0.03±0.2 0±0 0.04±0.25 p__J088 0.02±0.11 0±0 0.03±0.14 p__Iainarchaeota 0.01±0.1 0±0 0.02±0.12 p__JAKLEM01 0.01±0.11 0±0 0.02±0.14 p__Omnitrophota 0.01±0.05 0±0 0.01±0.06 phylum_summary %&gt;% filter(phylum %in% phylum_arrange) %&gt;% mutate(phylum=factor(phylum,levels=rev(phylum_arrange))) %&gt;% filter(relabun &gt; 0) %&gt;% ggplot(aes(x=relabun, y=phylum, group=phylum, color=phylum)) + scale_color_manual(values=phylum_colors[-8]) + geom_jitter(alpha=0.5, show.legend = FALSE) + facet_grid(.~season)+ theme_minimal() + labs(y=&quot;Family&quot;, x=&quot;Relative abundance&quot;, color=&quot;Phylum&quot;) 5.3 Family relative abundances family_summary &lt;- genome_counts_filt %&gt;% mutate_at(vars(-genome),~./sum(.)) %&gt;% #apply TSS nornalisation pivot_longer(-genome, names_to = &quot;sample&quot;, values_to = &quot;count&quot;) %&gt;% #reduce to minimum number of columns left_join(sample_metadata, by = join_by(sample == sample)) %&gt;% #append sample metadata left_join(., genome_metadata, by = join_by(genome == genome)) %&gt;% #append genome metadata group_by(sample,family, type, region, season) %&gt;% summarise(relabun=sum(count)) family_arrange &lt;- family_summary %&gt;% group_by(family) %&gt;% summarise(mean=sum(relabun)) %&gt;% arrange(-mean) %&gt;% select(family) %&gt;% pull() family_summary %&gt;% left_join(genome_metadata %&gt;% dplyr::select(family,phylum) %&gt;% unique(),by=join_by(family==family)) %&gt;% # left_join(sample_metadata,by=join_by(sample==sample)) %&gt;% filter(family %in% family_arrange[1:20]) %&gt;% mutate(family=factor(family,levels=rev(family_arrange[1:20]))) %&gt;% filter(relabun &gt; 0) %&gt;% ggplot(aes(x=relabun, y=family, group=family, color=phylum)) + scale_color_manual(values=phylum_colors) + geom_jitter(alpha=0.5) + theme_minimal() + labs(y=&quot;Family&quot;, x=&quot;Relative abundance&quot;, color=&quot;Phylum&quot;) 5.3.1 Per pond family_summary %&gt;% group_by(family) %&gt;% summarise(total_mean=mean(relabun*100, na.rm=T), total_sd=sd(relabun*100, na.rm=T), natural_mean=mean(relabun[type==&quot;natural&quot;]*100, na.rm=T), natural_sd=sd(relabun[type==&quot;natural&quot;]*100, na.rm=T), protected_mean=mean(relabun[type==&quot;protected&quot;]*100, na.rm=T), protected_sd=sd(relabun[type==&quot;protected&quot;]*100, na.rm=T), urban_mean=mean(relabun[type==&quot;urban&quot;]*100, na.rm=T), urban_sd=sd(relabun[type==&quot;urban&quot;]*100, na.rm=T)) %&gt;% mutate(total=str_c(round(total_mean,2),&quot;±&quot;,round(total_sd,2)), natural=str_c(round(natural_mean,2),&quot;±&quot;,round(natural_sd,2)), protected=str_c(round(protected_mean,2),&quot;±&quot;,round(protected_sd,2)), urban=str_c(round(urban_mean,2),&quot;±&quot;,round(urban_sd,2))) %&gt;% arrange(-total_mean) %&gt;% dplyr::select(family,total,natural,protected,urban) %&gt;% tt() tinytable_ysupt72lc3pe8rrbsv33 .table td.tinytable_css_hbh089f64j7uh6lm61f7, .table th.tinytable_css_hbh089f64j7uh6lm61f7 { border-bottom: solid 0.1em #d3d8dc; } family total natural protected urban f__Rikenellaceae 19.24±15.88 21.56±16 16.39±18.36 18.8±11.83 f__Bacteroidaceae 17.76±15.59 13.58±15.39 24.32±16.86 16.77±11.57 f__Tannerellaceae 8.3±7.4 5.02±6.44 11.2±8.17 10.33±5.71 f__Lachnospiraceae 4.6±4.74 2.96±3.69 6.66±6.02 4.87±3.47 f__Mycoplasmoidaceae 4.22±6.93 5.61±8.92 2.78±4.29 3.63±5.26 f__Aeromonadaceae 4.15±10.69 3.35±9.89 4.22±9.85 5.47±13.15 f__Ruminococcaceae 4.08±3.91 4.28±4.41 3.9±3.98 3.97±2.91 f__Marinifilaceae 3±3.32 1.91±2.49 3.93±4.15 3.73±2.97 f__Akkermansiaceae 2.9±4.04 2.81±3.77 2.97±4.33 2.97±4.31 f__Enterobacteriaceae 2.67±6.28 2.28±5.65 3.73±8.03 2.03±4.75 f__ 2.22±2.48 2.37±2.89 2.02±2.22 2.21±2.06 f__Clostridiaceae 2.14±3.23 1.67±1.76 2.37±5 2.65±2.24 f__Desulfovibrionaceae 1.73±1.88 1.49±1.68 1.51±1.92 2.44±2.03 f__Chlorobiaceae 1.52±9.28 3.48±13.92 0±0 0.02±0.07 f__Chromatiaceae 1.33±5.58 2.36±7.66 0.76±4.07 0.27±0.66 f__Butyricicoccaceae 1.32±5.64 0.44±0.85 3.28±9.8 0.39±0.86 f__Erysipelotrichaceae 1.25±2.02 1.62±2.77 0.87±1.09 1.08±1.15 f__Diplorickettsiaceae 0.99±8.81 2.21±13.36 0.03±0.11 0.08±0.25 f__Cellulosilyticaceae 0.69±1.35 0.42±0.72 0.34±0.73 1.59±2.2 f__FACHB-T130 0.68±6.41 1.57±9.72 0±0 0±0 f__CAG-239 0.64±1.08 0.33±0.46 0.89±1.55 0.86±1.04 f__VadinHA17 0.55±1.87 0.99±2.41 0±0 0.48±1.85 f__Methylococcaceae 0.55±3.81 1.26±5.75 0±0 0±0 f__Fusobacteriaceae 0.52±1.23 0.26±0.51 0.45±1.36 1.05±1.74 f__Polyangiaceae 0.5±4.84 0±0 0±0 2.02±9.68 f__EnvOPS12 0.47±1.77 0.71±1.82 0.09±0.48 0.53±2.55 f__Oscillospiraceae 0.41±0.45 0.28±0.36 0.6±0.56 0.4±0.34 f__Rhodocyclaceae 0.41±2.05 0.88±3.06 0±0 0.09±0.2 f__Gastranaerophilaceae 0.39±0.67 0.3±0.62 0.31±0.56 0.64±0.81 f__Anaerovoracaceae 0.37±0.46 0.39±0.54 0.25±0.32 0.48±0.44 f__Pumilibacteraceae 0.34±1.11 0.57±1.61 0.15±0.22 0.2±0.5 f__P3 0.34±0.64 0.36±0.53 0.27±0.67 0.39±0.78 f__UBA1997 0.34±0.81 0.32±0.72 0.1±0.3 0.67±1.2 f__Mucispirillaceae 0.31±0.9 0.52±1.33 0.12±0.21 0.17±0.24 f__CAIVKH01 0.3±2.01 0.69±3.03 0±0 0±0 f__UBA3637 0.3±0.65 0.18±0.52 0.36±0.74 0.45±0.74 f__UBA11358 0.28±1.11 0.65±1.62 0±0 0±0 f__Peptostreptococcaceae 0.26±0.66 0.3±0.51 0.33±1 0.1±0.17 f__Burkholderiaceae_B 0.26±1.3 0.3±1.53 0±0 0.52±1.65 f__Methylomonadaceae 0.25±1.68 0.57±2.53 0±0.01 0±0 f__Competibacteraceae 0.25±2.33 0.01±0.05 0.77±4.15 0.01±0.04 f__Chitinophagaceae 0.25±1.22 0.57±1.81 0±0 0.01±0.03 f__Peptococcaceae 0.24±0.36 0.08±0.22 0.32±0.31 0.43±0.48 f__CHK158-818 0.23±0.4 0.13±0.3 0.18±0.26 0.47±0.58 f__Muribaculaceae 0.22±0.37 0.31±0.45 0.1±0.22 0.23±0.32 f__SHND01 0.21±1.4 0.48±2.1 0±0 0±0 f__Chromobacteriaceae 0.2±1.39 0.44±2.1 0±0 0.04±0.12 f__Smithellaceae 0.19±1.78 0±0 0±0 0.78±3.55 f__Chloroflexaceae 0.19±1.8 0±0 0.6±3.21 0±0 f__UBA6186 0.17±1.46 0±0 0.51±2.59 0.03±0.12 f__Pseudopelobacteraceae 0.17±0.98 0.38±1.46 0±0 0±0 f__Microcystaceae_B 0.17±1.54 0.01±0.05 0.51±2.74 0±0 f__Saprospiraceae 0.16±0.89 0.37±1.33 0±0 0±0 f__Succinispiraceae 0.14±0.24 0.17±0.27 0.04±0.11 0.22±0.26 f__Anaerotignaceae 0.14±0.24 0.12±0.26 0.14±0.21 0.18±0.22 f__Prolixibacteraceae 0.14±0.71 0.16±0.5 0±0 0.26±1.26 f__Palsa-965 0.13±0.89 0.3±1.33 0±0 0±0 f__UBA4823 0.13±1.22 0±0 0±0 0.51±2.44 f__Opitutaceae 0.13±1.2 0±0 0±0 0.5±2.41 f__Microcoleaceae 0.12±0.81 0.09±0.48 0.26±1.33 0±0 f__UBA3700 0.12±0.44 0.08±0.21 0.19±0.71 0.11±0.24 f__B-1AR 0.12±0.81 0.1±0.56 0±0 0.3±1.44 f__Massilibacillaceae 0.12±0.56 0±0 0.34±0.97 0.04±0.16 f__UBA5066 0.11±0.78 0.26±1.17 0±0 0±0 f__HGW-15 0.1±0.78 0±0 0±0 0.41±1.55 f__UBA5704 0.1±0.96 0.23±1.45 0±0 0±0 f__Planctomycetaceae 0.1±0.94 0.23±1.43 0±0 0±0 f__Methanoregulaceae 0.09±0.74 0.03±0.19 0±0 0.3±1.45 f__Staskawiczbacteraceae 0.09±0.77 0.2±1.17 0±0 0±0 f__B-17BO 0.08±0.54 0.19±0.82 0±0 0±0 f__CAG-465 0.07±0.36 0±0 0.17±0.59 0.09±0.25 f__Paludibacteraceae 0.07±0.56 0.04±0.25 0±0 0.23±1.07 f__GW2011-AR1 0.07±0.65 0.17±0.99 0±0 0±0 f__UBA10030 0.07±0.42 0.17±0.62 0±0 0±0 f__Methanotrichaceae 0.07±0.68 0±0 0±0 0.29±1.35 f__UBA932 0.07±0.19 0.03±0.11 0.08±0.23 0.13±0.24 f__Ignavibacteriaceae 0.07±0.58 0.16±0.88 0±0 0±0 f__Acutalibacteraceae 0.07±0.39 0.13±0.58 0.03±0.13 0±0 f__CAIRTM01 0.06±0.39 0.15±0.59 0±0 0±0 f__OLB5 0.06±0.35 0.14±0.52 0±0 0±0 f__Beijerinckiaceae 0.06±0.28 0.14±0.42 0±0 0±0 f__Victivallaceae 0.06±0.28 0.02±0.06 0±0 0.2±0.54 f__UBA4417 0.06±0.33 0.13±0.5 0±0 0±0 f__Methylophilaceae 0.06±0.29 0.11±0.43 0±0 0.03±0.08 f__UBA3830 0.06±0.15 0.04±0.08 0.02±0.08 0.13±0.26 f__UBA12108 0.05±0.43 0.12±0.65 0±0 0±0 f__TH1-2 0.05±0.31 0.11±0.47 0±0 0±0 f__Shewanellaceae 0.05±0.22 0.03±0.2 0.09±0.3 0.02±0.07 f__F082 0.05±0.37 0.11±0.57 0±0 0±0 f__Arcobacteraceae 0.05±0.28 0.1±0.43 0.01±0.03 0±0.01 f__WRBN01 0.04±0.26 0.01±0.04 0±0 0.17±0.51 f__Methanocorpusculaceae 0.04±0.16 0.06±0.2 0.04±0.18 0.03±0.06 f__Acidobacteriaceae 0.04±0.41 0±0 0±0 0.17±0.82 f__Hepatoplasmataceae 0.04±0.29 0.04±0.26 0±0 0.1±0.48 f__Methanobacteriaceae 0.04±0.28 0.09±0.42 0±0 0.01±0.05 f__UBA660 0.04±0.23 0.04±0.26 0.07±0.29 0±0.02 f__DYRC01 0.04±0.39 0±0 0±0 0.16±0.79 f__RUG14156 0.04±0.23 0.06±0.33 0±0 0.05±0.14 f__JADJPG01 0.04±0.27 0.09±0.41 0±0 0±0 f__SZUA-47 0.04±0.22 0.09±0.33 0±0 0±0 f__Pyrinomonadaceae 0.04±0.24 0.09±0.37 0±0 0±0 f__LL51 0.04±0.17 0.01±0.05 0.1±0.29 0±0 f__Pirellulaceae 0.04±0.29 0.08±0.44 0±0 0±0 f__FEN-979 0.04±0.21 0.08±0.31 0±0 0±0 f__UBA9973 0.03±0.15 0.05±0.18 0±0 0.04±0.18 f__Rhizobiaceae 0.03±0.15 0.07±0.22 0±0 0±0 f__SHXO01 0.03±0.14 0.07±0.21 0±0 0±0 f__Rhabdochlamydiaceae 0.03±0.14 0.06±0.21 0±0 0±0 f__2-12-FULL-35-15 0.03±0.22 0.06±0.33 0±0 0±0 f__Aestuariivirgaceae 0.03±0.11 0.06±0.17 0±0 0±0 f__Syntrophorhabdaceae 0.03±0.2 0.01±0.08 0±0 0.08±0.39 f__Sedimentibacteraceae 0.03±0.07 0.01±0.03 0.06±0.11 0.02±0.07 f__UBA2023 0.02±0.2 0.06±0.31 0±0 0±0 f__Coprobacillaceae 0.02±0.07 0.03±0.06 0.03±0.1 0±0.01 f__Spirosomaceae 0.02±0.12 0.03±0.15 0.03±0.11 0±0 f__UBA3375 0.02±0.11 0.05±0.16 0±0 0.01±0.02 f__Sphingomonadaceae 0.02±0.11 0.05±0.16 0±0 0±0 f__Thermoanaerobaculaceae 0.02±0.22 0±0 0±0 0.09±0.43 f__Fen-1058 0.02±0.2 0±0 0±0 0.09±0.39 f__DUVY01 0.02±0.06 0.02±0.05 0.03±0.08 0.02±0.06 f__UBA927 0.02±0.1 0.04±0.14 0±0 0.02±0.1 f__JAAUTT01 0.02±0.12 0.05±0.17 0±0 0±0 f__GWF2-50-10 0.02±0.13 0.05±0.2 0±0 0±0 f__UBA3254 0.02±0.13 0.04±0.2 0±0 0±0 f__GWA2-36-10 0.02±0.15 0.04±0.22 0±0 0±0 f__JAAYKM01 0.02±0.18 0±0 0±0 0.08±0.36 f__SG8-41 0.02±0.15 0.04±0.22 0±0 0±0 f__Crocinitomicaceae 0.02±0.12 0±0 0±0 0.07±0.24 f__Holophagaceae 0.02±0.18 0±0 0±0 0.07±0.35 f__Absconditicoccaceae 0.02±0.15 0.04±0.23 0±0 0±0 f__Rectinemataceae 0.02±0.17 0±0 0±0 0.07±0.34 f__Ilumatobacteraceae 0.02±0.12 0.04±0.18 0±0 0±0 f__UBA6016 0.02±0.11 0±0 0±0 0.07±0.21 f__Lutisporaceae 0.02±0.04 0.01±0.03 0.01±0.03 0.04±0.06 f__4484-276 0.02±0.1 0.04±0.16 0±0 0±0 f__Terrimicrobiaceae 0.02±0.06 0.03±0.09 0±0 0±0.02 f__UBA4778 0.02±0.09 0.02±0.08 0±0 0.03±0.14 f__Eubacteriaceae 0.02±0.05 0±0 0.02±0.04 0.04±0.09 f__SPBP01 0.01±0.09 0.03±0.13 0±0 0±0 f__Gemmataceae 0.01±0.14 0.03±0.21 0±0 0±0 f__UBA1568 0.01±0.1 0.03±0.16 0±0 0±0 f__XYD1-FULL-46-19 0.01±0.11 0.03±0.16 0±0 0±0 f__UBA920 0.01±0.1 0.03±0.15 0±0 0±0 f__CAG-508 0.01±0.08 0.02±0.12 0±0.02 0.01±0.03 f__Steroidobacteraceae 0.01±0.08 0.03±0.11 0±0 0±0 f__JAAZKV01 0.01±0.1 0.03±0.15 0±0 0±0 f__UBA5976 0.01±0.08 0.03±0.11 0±0 0±0.02 f__Burkholderiaceae_A 0.01±0.09 0.03±0.14 0±0 0±0 f__JAKLEM01 0.01±0.11 0±0 0±0 0.05±0.22 f__Brevinemataceae 0.01±0.07 0.01±0.06 0.02±0.09 0±0 f__Amoebophilaceae 0.01±0.05 0.02±0.07 0±0 0±0 f__Profunditerraquicolaceae 0.01±0.05 0.02±0.07 0±0 0±0 f__JAGOQP01 0.01±0.09 0±0 0±0 0.04±0.17 f__Mycoplasmataceae 0.01±0.06 0±0 0±0 0.04±0.11 f__Microbacteriaceae 0.01±0.06 0.02±0.08 0±0 0±0.01 f__UBA1709 0.01±0.08 0.02±0.12 0±0 0±0 f__UBA1820 0.01±0.02 0.01±0.02 0.01±0.02 0.01±0.02 f__Burkholderiaceae 0.01±0.03 0.01±0.04 0±0 0±0.01 f__JAGQMS01 0.01±0.03 0.02±0.05 0±0 0±0 f__Tenuifilaceae 0.01±0.05 0.01±0.07 0±0 0±0 f__UBA5272 0.01±0.05 0.01±0.07 0±0 0±0 f__Flavobacteriaceae 0.01±0.05 0.01±0.07 0±0 0±0 f__Moraxellaceae 0±0.04 0±0 0.02±0.06 0±0 f__Zambryskibacteraceae 0±0.04 0.01±0.06 0±0 0±0 f__JAFDDL01 0±0.04 0±0 0±0 0.02±0.09 f__2-12-FULL-60-25 0±0.02 0.01±0.04 0±0 0±0 f__UBA12049 0±0.03 0.01±0.04 0±0 0±0 f__PALSA-1337 0±0.02 0.01±0.03 0±0 0±0 f__CAIOMD01 0±0.01 0±0.02 0±0 0±0 family_arrange &lt;- family_summary %&gt;% group_by(family) %&gt;% summarise(mean=sum(relabun)) %&gt;% arrange(-mean) %&gt;% dplyr::select(family) %&gt;% pull() family_summary %&gt;% left_join(genome_metadata %&gt;% dplyr::select(family,phylum) %&gt;% unique(),by=join_by(family==family)) %&gt;% # left_join(sample_metadata,by=join_by(sample==sample)) %&gt;% filter(family %in% family_arrange[1:20]) %&gt;% mutate(family=factor(family,levels=rev(family_arrange[1:20]))) %&gt;% filter(relabun &gt; 0) %&gt;% ggplot(aes(x=relabun, y=family, group=family, color=phylum)) + scale_color_manual(values=phylum_colors) + geom_jitter(alpha=0.5) + facet_grid(.~type)+ theme_minimal() + labs(y=&quot;Family&quot;, x=&quot;Relative abundance&quot;, color=&quot;Phylum&quot;) # Per origin # family_summary %&gt;% # left_join(genome_metadata %&gt;% dplyr::select(family,phylum) %&gt;% unique(),by=join_by(family==family)) %&gt;% # # left_join(sample_metadata,by=join_by(sample==sample)) %&gt;% # filter(family %in% family_arrange[1:20]) %&gt;% # mutate(family=factor(family,levels=rev(family_arrange[1:20]))) %&gt;% # filter(relabun &gt; 0) %&gt;% # ggplot(aes(x=relabun, y=family, group=family, color=phylum)) + # scale_color_manual(values=phylum_colors[-8]) + # geom_jitter(alpha=0.5) + # facet_grid(.~region)+ # theme_minimal() + # labs(y=&quot;Family&quot;, x=&quot;Relative abundance&quot;, color=&quot;Phylum&quot;) 5.3.2 Per season family_summary %&gt;% group_by(family) %&gt;% summarise(total_mean=mean(relabun*100, na.rm=T), total_sd=sd(relabun*100, na.rm=T), spring_mean=mean(relabun[season==&quot;spring&quot;]*100, na.rm=T), spring_sd=sd(relabun[season==&quot;spring&quot;]*100, na.rm=T), autumn_mean=mean(relabun[season==&quot;autumn&quot;]*100, na.rm=T), autumn_sd=sd(relabun[season==&quot;autumn&quot;]*100, na.rm=T)) %&gt;% mutate(total=str_c(round(total_mean,2),&quot;±&quot;,round(total_sd,2)), spring=str_c(round(spring_mean,2),&quot;±&quot;,round(spring_sd,2)), autumn=str_c(round(autumn_mean,2),&quot;±&quot;,round(autumn_sd,2))) %&gt;% arrange(-total_mean) %&gt;% dplyr::select(family,total,spring,autumn) %&gt;% tt() tinytable_hb37dpfla3mfsnq7afmy .table td.tinytable_css_fkbx2i6nb1w5rb2b22d6, .table th.tinytable_css_fkbx2i6nb1w5rb2b22d6 { border-bottom: solid 0.1em #d3d8dc; } family total spring autumn f__Rikenellaceae 19.24±15.88 21.24±11.62 18.17±17.74 f__Bacteroidaceae 17.76±15.59 12.4±8.63 20.62±17.65 f__Tannerellaceae 8.3±7.4 7.78±5.55 8.57±8.24 f__Lachnospiraceae 4.6±4.74 4.99±5.37 4.4±4.4 f__Mycoplasmoidaceae 4.22±6.93 4.36±4.98 4.15±7.82 f__Aeromonadaceae 4.15±10.69 4.36±9.73 4.04±11.25 f__Ruminococcaceae 4.08±3.91 6.17±4.42 2.97±3.11 f__Marinifilaceae 3±3.32 4.8±3.78 2.04±2.61 f__Akkermansiaceae 2.9±4.04 3.9±4.69 2.37±3.58 f__Enterobacteriaceae 2.67±6.28 3.18±7.34 2.4±5.69 f__ 2.22±2.48 2.83±2.55 1.89±2.4 f__Clostridiaceae 2.14±3.23 2.22±2.57 2.09±3.55 f__Desulfovibrionaceae 1.73±1.88 2.63±2.09 1.25±1.57 f__Chlorobiaceae 1.52±9.28 0±0 2.33±11.44 f__Chromatiaceae 1.33±5.58 2.04±6.47 0.95±5.07 f__Butyricicoccaceae 1.32±5.64 0.78±1.39 1.61±6.91 f__Erysipelotrichaceae 1.25±2.02 1.05±1.03 1.35±2.39 f__Diplorickettsiaceae 0.99±8.81 0±0 1.52±10.91 f__Cellulosilyticaceae 0.69±1.35 0.66±0.83 0.7±1.57 f__FACHB-T130 0.68±6.41 0±0 1.05±7.94 f__CAG-239 0.64±1.08 1.18±1.46 0.35±0.66 f__VadinHA17 0.55±1.87 0.03±0.17 0.83±2.27 f__Methylococcaceae 0.55±3.81 1.35±6.41 0.12±0.59 f__Fusobacteriaceae 0.52±1.23 0.31±0.53 0.62±1.47 f__Polyangiaceae 0.5±4.84 0±0 0.77±6 f__EnvOPS12 0.47±1.77 0.08±0.46 0.67±2.14 f__Oscillospiraceae 0.41±0.45 0.59±0.47 0.32±0.41 f__Rhodocyclaceae 0.41±2.05 0.15±0.63 0.54±2.5 f__Gastranaerophilaceae 0.39±0.67 0.49±0.65 0.33±0.67 f__Anaerovoracaceae 0.37±0.46 0.45±0.49 0.32±0.44 f__Pumilibacteraceae 0.34±1.11 0.64±1.77 0.19±0.4 f__P3 0.34±0.64 0.51±0.7 0.25±0.59 f__UBA1997 0.34±0.81 0.31±0.64 0.35±0.89 f__Mucispirillaceae 0.31±0.9 0.21±0.23 0.36±1.11 f__CAIVKH01 0.3±2.01 0±0 0.46±2.48 f__UBA3637 0.3±0.65 0.68±0.92 0.1±0.32 f__UBA11358 0.28±1.11 0.22±0.86 0.32±1.23 f__Peptostreptococcaceae 0.26±0.66 0.38±0.67 0.2±0.65 f__Burkholderiaceae_B 0.26±1.3 0.01±0.05 0.39±1.6 f__Methylomonadaceae 0.25±1.68 0±0 0.38±2.07 f__Competibacteraceae 0.25±2.33 0.71±3.95 0±0 f__Chitinophagaceae 0.25±1.22 0±0 0.38±1.49 f__Peptococcaceae 0.24±0.36 0.29±0.34 0.22±0.37 f__CHK158-818 0.23±0.4 0.39±0.55 0.14±0.26 f__Muribaculaceae 0.22±0.37 0.46±0.48 0.1±0.21 f__SHND01 0.21±1.4 0.48±2.27 0.06±0.48 f__Chromobacteriaceae 0.2±1.39 0.58±2.34 0±0 f__Smithellaceae 0.19±1.78 0±0 0.3±2.2 f__Chloroflexaceae 0.19±1.8 0.54±3.06 0±0.01 f__UBA6186 0.17±1.46 0.46±2.47 0.01±0.08 f__Pseudopelobacteraceae 0.17±0.98 0±0 0.25±1.2 f__Microcystaceae_B 0.17±1.54 0.46±2.6 0.01±0.04 f__Saprospiraceae 0.16±0.89 0±0 0.25±1.09 f__Succinispiraceae 0.14±0.24 0.12±0.17 0.15±0.27 f__Anaerotignaceae 0.14±0.24 0.15±0.23 0.13±0.24 f__Prolixibacteraceae 0.14±0.71 0±0 0.21±0.87 f__Palsa-965 0.13±0.89 0±0 0.2±1.09 f__UBA4823 0.13±1.22 0±0 0.19±1.51 f__Opitutaceae 0.13±1.2 0±0 0.19±1.49 f__Microcoleaceae 0.12±0.81 0.35±1.35 0±0.01 f__UBA3700 0.12±0.44 0.21±0.68 0.07±0.2 f__B-1AR 0.12±0.81 0±0 0.18±0.99 f__Massilibacillaceae 0.12±0.56 0.16±0.78 0.09±0.42 f__UBA5066 0.11±0.78 0.3±1.3 0.02±0.13 f__HGW-15 0.1±0.78 0±0 0.16±0.96 f__UBA5704 0.1±0.96 0±0 0.15±1.19 f__Planctomycetaceae 0.1±0.94 0±0 0.15±1.17 f__Methanoregulaceae 0.09±0.74 0±0 0.14±0.91 f__Staskawiczbacteraceae 0.09±0.77 0±0 0.13±0.95 f__B-17BO 0.08±0.54 0±0 0.13±0.67 f__CAG-465 0.07±0.36 0.19±0.58 0.01±0.07 f__Paludibacteraceae 0.07±0.56 0±0 0.11±0.69 f__GW2011-AR1 0.07±0.65 0±0 0.11±0.81 f__UBA10030 0.07±0.42 0±0 0.11±0.51 f__Methanotrichaceae 0.07±0.68 0±0 0.11±0.84 f__UBA932 0.07±0.19 0.12±0.24 0.04±0.16 f__Ignavibacteriaceae 0.07±0.58 0.02±0.12 0.09±0.72 f__Acutalibacteraceae 0.07±0.39 0.07±0.19 0.06±0.47 f__CAIRTM01 0.06±0.39 0.08±0.37 0.06±0.41 f__OLB5 0.06±0.35 0±0 0.1±0.43 f__Beijerinckiaceae 0.06±0.28 0±0 0.1±0.35 f__Victivallaceae 0.06±0.28 0.02±0.07 0.08±0.34 f__UBA4417 0.06±0.33 0.02±0.11 0.07±0.41 f__Methylophilaceae 0.06±0.29 0±0 0.09±0.35 f__UBA3830 0.06±0.15 0.06±0.13 0.06±0.16 f__UBA12108 0.05±0.43 0±0 0.08±0.53 f__TH1-2 0.05±0.31 0±0 0.08±0.38 f__Shewanellaceae 0.05±0.22 0±0 0.07±0.26 f__F082 0.05±0.37 0.03±0.11 0.06±0.46 f__Arcobacteraceae 0.05±0.28 0.04±0.13 0.05±0.34 f__WRBN01 0.04±0.26 0.12±0.43 0±0.03 f__Methanocorpusculaceae 0.04±0.16 0.02±0.05 0.06±0.2 f__Acidobacteriaceae 0.04±0.41 0±0 0.07±0.51 f__Hepatoplasmataceae 0.04±0.29 0±0 0.07±0.36 f__Methanobacteriaceae 0.04±0.28 0.03±0.11 0.05±0.34 f__UBA660 0.04±0.23 0.12±0.39 0±0.01 f__DYRC01 0.04±0.39 0±0 0.06±0.49 f__RUG14156 0.04±0.23 0.03±0.12 0.04±0.27 f__JADJPG01 0.04±0.27 0±0 0.06±0.33 f__SZUA-47 0.04±0.22 0±0 0.06±0.27 f__Pyrinomonadaceae 0.04±0.24 0.09±0.4 0.01±0.07 f__LL51 0.04±0.17 0.08±0.27 0.01±0.05 f__Pirellulaceae 0.04±0.29 0±0 0.06±0.36 f__FEN-979 0.04±0.21 0±0 0.06±0.25 f__UBA9973 0.03±0.15 0±0 0.05±0.19 f__Rhizobiaceae 0.03±0.15 0±0 0.05±0.18 f__SHXO01 0.03±0.14 0±0 0.04±0.18 f__Rhabdochlamydiaceae 0.03±0.14 0±0 0.04±0.18 f__2-12-FULL-35-15 0.03±0.22 0±0 0.04±0.27 f__Aestuariivirgaceae 0.03±0.11 0±0 0.04±0.14 f__Syntrophorhabdaceae 0.03±0.2 0±0 0.04±0.25 f__Sedimentibacteraceae 0.03±0.07 0.02±0.07 0.03±0.07 f__UBA2023 0.02±0.2 0±0 0.04±0.25 f__Coprobacillaceae 0.02±0.07 0.01±0.04 0.03±0.08 f__Spirosomaceae 0.02±0.12 0.02±0.1 0.03±0.13 f__UBA3375 0.02±0.11 0±0 0.04±0.13 f__Sphingomonadaceae 0.02±0.11 0±0 0.04±0.13 f__Thermoanaerobaculaceae 0.02±0.22 0±0 0.03±0.27 f__Fen-1058 0.02±0.2 0±0 0.03±0.24 f__DUVY01 0.02±0.06 0.01±0.05 0.03±0.07 f__UBA927 0.02±0.1 0±0 0.03±0.13 f__JAAUTT01 0.02±0.12 0±0 0.03±0.14 f__GWF2-50-10 0.02±0.13 0±0 0.03±0.16 f__UBA3254 0.02±0.13 0±0 0.03±0.16 f__GWA2-36-10 0.02±0.15 0±0 0.03±0.18 f__JAAYKM01 0.02±0.18 0±0 0.03±0.23 f__SG8-41 0.02±0.15 0±0 0.03±0.18 f__Crocinitomicaceae 0.02±0.12 0±0 0.03±0.15 f__Holophagaceae 0.02±0.18 0±0 0.03±0.22 f__Absconditicoccaceae 0.02±0.15 0±0 0.03±0.19 f__Rectinemataceae 0.02±0.17 0±0 0.03±0.21 f__Ilumatobacteraceae 0.02±0.12 0±0 0.03±0.15 f__UBA6016 0.02±0.11 0±0 0.03±0.13 f__Lutisporaceae 0.02±0.04 0.03±0.05 0.01±0.03 f__4484-276 0.02±0.1 0±0 0.03±0.13 f__Terrimicrobiaceae 0.02±0.06 0±0.02 0.02±0.07 f__UBA4778 0.02±0.09 0.01±0.03 0.02±0.1 f__Eubacteriaceae 0.02±0.05 0.03±0.07 0.01±0.03 f__SPBP01 0.01±0.09 0±0 0.02±0.11 f__Gemmataceae 0.01±0.14 0±0 0.02±0.17 f__UBA1568 0.01±0.1 0±0 0.02±0.13 f__XYD1-FULL-46-19 0.01±0.11 0±0 0.02±0.13 f__UBA920 0.01±0.1 0±0 0.02±0.12 f__CAG-508 0.01±0.08 0.03±0.13 0±0.02 f__Steroidobacteraceae 0.01±0.08 0±0 0.02±0.09 f__JAAZKV01 0.01±0.1 0±0 0.02±0.12 f__UBA5976 0.01±0.08 0±0 0.02±0.09 f__Burkholderiaceae_A 0.01±0.09 0.03±0.16 0±0 f__JAKLEM01 0.01±0.11 0±0 0.02±0.14 f__Brevinemataceae 0.01±0.07 0.01±0.04 0.01±0.08 f__Amoebophilaceae 0.01±0.05 0±0 0.01±0.06 f__Profunditerraquicolaceae 0.01±0.05 0±0 0.01±0.06 f__JAGOQP01 0.01±0.09 0±0 0.01±0.11 f__Mycoplasmataceae 0.01±0.06 0±0.01 0.01±0.07 f__Microbacteriaceae 0.01±0.06 0±0 0.01±0.07 f__UBA1709 0.01±0.08 0±0 0.01±0.1 f__UBA1820 0.01±0.02 0.01±0.02 0.01±0.02 f__Burkholderiaceae 0.01±0.03 0±0 0.01±0.04 f__JAGQMS01 0.01±0.03 0±0 0.01±0.04 f__Tenuifilaceae 0.01±0.05 0±0 0.01±0.06 f__UBA5272 0.01±0.05 0±0 0.01±0.06 f__Flavobacteriaceae 0.01±0.05 0±0 0.01±0.06 f__Moraxellaceae 0±0.04 0±0 0.01±0.04 f__Zambryskibacteraceae 0±0.04 0±0 0.01±0.05 f__JAFDDL01 0±0.04 0±0 0.01±0.05 f__2-12-FULL-60-25 0±0.02 0±0 0.01±0.03 f__UBA12049 0±0.03 0±0 0.01±0.04 f__PALSA-1337 0±0.02 0±0 0±0.02 f__CAIOMD01 0±0.01 0±0 0±0.02 family_summary %&gt;% left_join(genome_metadata %&gt;% dplyr::select(family,phylum) %&gt;% unique(),by=join_by(family==family)) %&gt;% # left_join(sample_metadata,by=join_by(sample==sample)) %&gt;% filter(family %in% family_arrange[1:20]) %&gt;% mutate(family=factor(family,levels=rev(family_arrange[1:20]))) %&gt;% filter(relabun &gt; 0) %&gt;% ggplot(aes(x=relabun, y=family, group=family, color=phylum)) + scale_color_manual(values=phylum_colors) +#[-8] geom_jitter(alpha=0.5) + facet_grid(.~season)+ theme_minimal() + labs(y=&quot;Family&quot;, x=&quot;Relative abundance&quot;, color=&quot;Phylum&quot;) 5.4 Genus relative abundances genus_summary &lt;- genome_counts_filt %&gt;% mutate_at(vars(-genome),~./sum(.)) %&gt;% #apply TSS nornalisation pivot_longer(-genome, names_to = &quot;sample&quot;, values_to = &quot;count&quot;) %&gt;% #reduce to minimum number of columns left_join(sample_metadata, by = join_by(sample == sample)) %&gt;% #append sample metadata left_join(genome_metadata, by = join_by(genome == genome)) %&gt;% #append genome metadata group_by(sample,phylum,genus, type, season) %&gt;% summarise(relabun=sum(count)) %&gt;% filter(genus != &quot;g__&quot;) %&gt;% mutate(genus= sub(&quot;^g__&quot;, &quot;&quot;, genus)) 5.4.1 Per pond genus_summary %&gt;% group_by(genus) %&gt;% summarise(total_mean=mean(relabun*100, na.rm=T), total_sd=sd(relabun*100, na.rm=T), natural_mean=mean(relabun[type==&quot;natural&quot;]*100, na.rm=T), natural_sd=sd(relabun[type==&quot;natural&quot;]*100, na.rm=T), protected_mean=mean(relabun[type==&quot;protected&quot;]*100, na.rm=T), protected_sd=sd(relabun[type==&quot;protected&quot;]*100, na.rm=T), urban_mean=mean(relabun[type==&quot;urban&quot;]*100, na.rm=T), urban_sd=sd(relabun[type==&quot;urban&quot;]*100, na.rm=T)) %&gt;% mutate(total=str_c(round(total_mean,2),&quot;±&quot;,round(total_sd,2)), natural=str_c(round(natural_mean,2),&quot;±&quot;,round(natural_sd,2)), protected=str_c(round(protected_mean,2),&quot;±&quot;,round(protected_sd,2)), urban=str_c(round(urban_mean,2),&quot;±&quot;,round(urban_sd,2))) %&gt;% arrange(-total_mean) %&gt;% dplyr::select(genus,total,natural,protected,urban) %&gt;% tt() tinytable_68kw7h5wt3ghmg59q8xu .table td.tinytable_css_99a8zzikhudomntmub6o, .table th.tinytable_css_99a8zzikhudomntmub6o { border-bottom: solid 0.1em #d3d8dc; } genus total natural protected urban Bacteroides 17.27±15.59 13.16±15.3 23.86±16.92 16.12±11.68 Mucinivorans 10.39±12.9 11.41±9.36 9.48±19.23 9.76±7.66 Parabacteroides 7.07±6.44 4.45±5.59 9.58±7.48 8.47±4.71 Aeromonas 4.15±10.69 3.35±9.89 4.22±9.85 5.47±13.15 Mycoplasma_L 3.78±6.81 5.42±8.83 2.17±4.18 2.96±4.7 Rikenella 2.79±5.08 3.21±5.27 2.46±4.91 2.48±5.12 JADFUS01 2.22±2.02 2.13±2.26 2.31±2.09 2.27±1.5 Odoribacter 1.87±2.46 1.12±1.88 2.74±3.29 2.1±1.73 Akkermansia 1.63±3.1 0.86±1.42 2.06±3.58 2.41±4.22 Clostridium 1.41±1.84 1.53±1.71 1.3±2.38 1.33±1.22 Chlorobaculum 1.26±7.85 2.88±11.79 0±0 0.01±0.04 UBA866 1.2±2.17 1.36±2.95 1.04±1.43 1.12±1.14 Parabacteroides_B 1.13±1.58 0.5±1.14 1.49±1.76 1.76±1.66 Aquirickettsiella 0.99±8.81 2.21±13.36 0.03±0.11 0.08±0.25 Hafnia 0.97±3.83 0.92±3.53 1.36±4.94 0.57±2.68 Buttiauxella 0.94±4.16 0.25±0.97 1.84±6.63 1.01±3.47 Mobilisporobacter 0.84±2.27 0.86±2.41 1.11±2.79 0.46±0.93 Thiodictyon 0.81±3.44 1.25±3.9 0.76±4.07 0.11±0.3 UMGS1251 0.77±1.13 0.26±0.59 1.04±1.48 1.29±1.02 Sarcina 0.73±1.94 0.14±0.53 1.07±2.89 1.32±1.83 Alistipes 0.68±0.97 1.03±1.24 0.28±0.47 0.58±0.65 FACHB-831 0.68±6.41 1.57±9.72 0±0 0±0 Hydrogenoanaerobacterium 0.66±1.76 0.89±2.49 0.45±0.81 0.53±0.89 Clostridium_Q 0.66±0.78 0.57±0.7 0.89±0.98 0.51±0.55 SZUA-378 0.57±1.52 0.09±0.28 1.57±2.41 0.13±0.26 Angelakisella 0.56±0.72 0.56±0.73 0.4±0.69 0.77±0.74 LD21 0.55±1.87 0.99±2.41 0±0 0.48±1.85 Malacoplasma 0.44±1.76 0.19±0.54 0.61±1.65 0.67±2.95 Tidjanibacter 0.41±0.75 0.51±0.85 0.34±0.79 0.34±0.49 Hungatella_A 0.4±0.64 0.29±0.56 0.42±0.68 0.57±0.71 OLB14 0.39±1.69 0.59±1.67 0±0 0.53±2.55 Budvicia 0.38±1.36 0.41±1.55 0.45±1.48 0.23±0.8 JAGNZR01 0.35±0.94 0.13±0.37 0.4±1.24 0.67±1.13 Anaerorhabdus 0.35±1.17 0.55±1.62 0.08±0.3 0.34±0.85 Anaerotruncus 0.31±0.48 0.27±0.47 0.35±0.56 0.35±0.41 OM05-12 0.3±0.5 0.27±0.37 0.28±0.63 0.39±0.5 CAIVKH01 0.3±2.01 0.69±3.03 0±0 0±0 Chlorobium 0.26±1.63 0.6±2.44 0±0 0.01±0.06 RXIV01 0.25±2.33 0.01±0.05 0.77±4.15 0.01±0.04 Gallalistipes 0.25±0.71 0.44±1.03 0.07±0.14 0.12±0.14 CAKVBE01 0.25±0.69 0.25±0.65 0.09±0.3 0.45±1.03 Dielma 0.23±0.36 0.15±0.32 0.26±0.36 0.34±0.39 HGM05232 0.22±0.37 0.31±0.45 0.1±0.22 0.23±0.32 SHND01 0.21±1.4 0.48±2.1 0±0 0±0 Avirikenella 0.2±0.64 0.33±0.91 0.1±0.3 0.12±0.3 UBA4132 0.2±1.49 0.47±2.25 0±0.01 0±0 Bilophila 0.2±0.32 0.25±0.36 0.14±0.29 0.2±0.3 Craterilacuibacter 0.2±1.39 0.43±2.1 0±0 0.04±0.12 Gallibacteroides 0.2±0.38 0.11±0.27 0.12±0.2 0.44±0.57 CAJGBR01 0.19±0.26 0.26±0.31 0.1±0.18 0.19±0.23 Chloroploca 0.19±1.8 0±0 0.6±3.21 0±0 Lamprocystis 0.18±0.88 0.35±1.3 0±0 0.12±0.28 FEN-1139 0.18±1.71 0±0 0±0 0.71±3.43 RUG14305 0.18±0.25 0.14±0.23 0.19±0.3 0.23±0.2 Alistipes_A 0.17±0.32 0.23±0.44 0.05±0.09 0.21±0.23 Smithella 0.17±1.55 0±0 0±0 0.68±3.09 UBA6186 0.17±1.46 0±0 0.51±2.59 0.03±0.12 Anaerovorax 0.17±0.32 0.22±0.38 0.04±0.13 0.23±0.33 Phocea 0.16±0.35 0.06±0.12 0.22±0.53 0.27±0.31 M3007 0.16±0.89 0.37±1.33 0±0 0±0 Romboutsia_D 0.16±0.34 0.26±0.39 0.09±0.36 0.07±0.15 Cetobacterium 0.16±0.45 0.12±0.31 0.04±0.15 0.38±0.74 JADLHS01 0.16±0.93 0.36±1.39 0±0 0±0 Scandinavium 0.15±0.85 0.23±1.23 0.04±0.19 0.14±0.49 Amedibacillus 0.15±0.43 0.2±0.54 0.14±0.41 0.06±0.15 JAGAJR01 0.14±0.29 0.15±0.29 0.12±0.26 0.17±0.31 Luteolibacter 0.14±0.53 0.32±0.78 0±0.01 0.02±0.07 GCA-2737665 0.13±0.89 0.3±1.33 0±0 0±0 Aminipila 0.13±0.18 0.13±0.2 0.13±0.18 0.13±0.15 CAIQJJ01 0.13±1.22 0±0 0±0 0.51±2.44 JADKHC01 0.13±1.2 0±0 0±0 0.5±2.41 JJ008 0.12±0.69 0.29±1.03 0±0 0±0 Intestinimonas 0.12±0.2 0.06±0.12 0.25±0.26 0.06±0.13 Citrobacter 0.12±1.12 0.28±1.69 0±0 0±0 Planktothrix 0.12±0.81 0.09±0.48 0.26±1.33 0±0 FEN-1279 0.12±0.81 0.1±0.56 0±0 0.3±1.44 Harryflintia 0.12±0.32 0.02±0.12 0.28±0.5 0.06±0.12 UBA5066 0.11±0.78 0.26±1.17 0±0 0±0 JACRCG01 0.11±0.7 0.26±1.05 0±0 0±0 Negativibacillus 0.11±0.35 0.03±0.19 0.21±0.51 0.13±0.3 Rhodoferax_C 0.11±0.86 0.25±1.3 0±0 0±0 CAIPUE01 0.11±0.28 0.13±0.35 0.09±0.24 0.09±0.19 WRKB01 0.11±0.21 0.05±0.11 0.12±0.24 0.19±0.28 Anaerotignum 0.1±0.23 0.12±0.26 0.04±0.15 0.16±0.23 Spyradomonas 0.1±0.3 0.06±0.24 0.03±0.11 0.25±0.47 TH-plancto1 0.1±0.94 0.23±1.43 0±0 0±0 Azonexus 0.09±0.43 0.17±0.63 0±0 0.07±0.2 Methanoregula 0.09±0.74 0.03±0.19 0±0 0.3±1.45 Pseudoflavonifractor 0.09±0.22 0.04±0.1 0.17±0.34 0.07±0.12 RGIG7389 0.08±0.15 0.04±0.1 0.1±0.18 0.12±0.16 UBA7488 0.08±0.28 0.03±0.15 0.13±0.42 0.11±0.21 UBA3961 0.08±0.37 0.18±0.55 0±0 0±0 RPPU01 0.08±0.75 0±0 0±0 0.31±1.5 RGIG5057 0.07±0.36 0±0 0.17±0.59 0.09±0.25 UMGS1202 0.07±0.14 0.04±0.08 0.1±0.16 0.11±0.18 CAIQQL01 0.07±0.65 0.17±0.99 0±0 0±0 Methanothrix 0.07±0.68 0±0 0±0 0.29±1.35 Egerieousia 0.07±0.19 0.03±0.11 0.08±0.23 0.13±0.24 UBA11358 0.07±0.35 0.16±0.52 0±0 0±0 IGN3 0.07±0.58 0.16±0.88 0±0 0±0 14-2 0.07±0.32 0.02±0.08 0.06±0.27 0.15±0.56 SKHV01 0.07±0.63 0±0 0±0 0.26±1.26 Butyribacter 0.06±0.61 0.15±0.93 0±0 0±0 CAIRTM01 0.06±0.39 0.15±0.59 0±0 0±0 OLB5 0.06±0.35 0.14±0.52 0±0 0±0 Methylocystis 0.06±0.28 0.14±0.42 0±0 0±0 Robinsoniella 0.06±0.21 0.02±0.08 0.13±0.31 0.05±0.19 UBA2475 0.06±0.39 0.14±0.58 0±0 0±0 JABFSR01 0.06±0.31 0.13±0.46 0±0 0±0 Paludibacter 0.06±0.54 0±0 0±0 0.23±1.07 Ruthenibacterium 0.06±0.2 0.12±0.29 0.01±0.04 0±0.01 UBA12294 0.06±0.31 0.07±0.25 0.09±0.48 0±0 Edwardsiella 0.05±0.17 0.1±0.24 0±0 0.04±0.12 CAJAUT01 0.05±0.43 0.12±0.65 0±0 0±0 JAKAJH01 0.05±0.39 0.12±0.59 0±0 0±0 CAIPTY01 0.05±0.28 0.12±0.43 0±0 0±0 Romboutsia_A 0.05±0.26 0.02±0.08 0.12±0.44 0.01±0.04 Bacteroides_G 0.05±0.25 0.12±0.37 0±0 0±0 Novimethylophilus 0.05±0.29 0.11±0.43 0±0 0±0 Vitreimonas 0.05±0.31 0.11±0.47 0±0 0±0 Shewanella 0.05±0.22 0.03±0.2 0.09±0.3 0.02±0.07 JAERTD01 0.05±0.37 0.11±0.57 0±0 0±0 JAGPHI01 0.05±0.25 0.11±0.38 0±0 0±0 Aliarcobacter 0.05±0.28 0.1±0.43 0.01±0.03 0±0.01 CAJLXD01 0.05±0.19 0.07±0.27 0.03±0.08 0.02±0.05 Methyloglobulus 0.05±0.22 0.1±0.32 0±0 0±0 JAHHUI01 0.04±0.26 0.01±0.04 0±0 0.17±0.51 Methanocorpusculum 0.04±0.16 0.06±0.2 0.04±0.18 0.03±0.06 Terracidiphilus 0.04±0.41 0±0 0±0 0.17±0.82 Methanobacterium_A 0.04±0.28 0.09±0.42 0±0 0.01±0.05 DYRC01 0.04±0.39 0±0 0±0 0.16±0.79 JAHHTP01 0.04±0.14 0.04±0.16 0.03±0.14 0.05±0.12 RGIG5270 0.04±0.22 0±0 0±0 0.16±0.42 Hylemonella 0.04±0.38 0±0 0±0 0.16±0.76 CALXSC01 0.04±0.22 0±0.03 0.01±0.02 0.14±0.42 Eubacterium_R 0.04±0.38 0.09±0.57 0±0 0±0 Scatenecus 0.04±0.15 0.04±0.18 0.02±0.09 0.06±0.16 Copranaerobaculum 0.04±0.16 0.04±0.2 0.04±0.11 0.04±0.13 RFTN01 0.04±0.22 0.09±0.33 0±0 0±0 JAEUNJ01 0.04±0.15 0.09±0.23 0±0 0±0 OLB17 0.04±0.24 0.09±0.37 0±0 0±0 Aureliella 0.04±0.29 0.08±0.44 0±0 0±0 FEN-979 0.04±0.21 0.08±0.31 0±0 0±0 Draconibacterium 0.04±0.16 0.08±0.23 0±0 0±0 UBA6024 0.03±0.21 0.08±0.31 0±0 0±0 Hespellia 0.03±0.19 0.05±0.28 0.01±0.05 0.03±0.06 Evtepia 0.03±0.06 0.03±0.06 0.05±0.07 0.02±0.04 Ferruginibacter 0.03±0.15 0.07±0.22 0±0 0.01±0.03 JAJBUQ01 0.03±0.06 0.02±0.05 0.02±0.06 0.07±0.09 Anaerobium 0.03±0.1 0.01±0.04 0.08±0.16 0±0 SHXO01 0.03±0.14 0.07±0.21 0±0 0±0 Bacilliculturomica 0.03±0.06 0.02±0.06 0.03±0.06 0.04±0.08 PALSA-1444 0.03±0.14 0.06±0.21 0±0 0±0 MGBC133411 0.03±0.16 0±0.01 0.06±0.28 0.02±0.06 2-12-FULL-35-15 0.03±0.22 0.06±0.33 0±0 0±0 Aestuariivirga 0.03±0.11 0.06±0.17 0±0 0±0 Syntrophorhabdus 0.03±0.2 0.01±0.08 0±0 0.08±0.39 Limnohabitans 0.03±0.16 0.04±0.23 0±0 0.03±0.09 JAAYQI01 0.03±0.1 0±0 0.07±0.16 0.02±0.06 IOR16 0.03±0.05 0.02±0.06 0.03±0.05 0.03±0.05 Coprobacillus 0.02±0.07 0.03±0.06 0.03±0.1 0±0.01 UBA5026 0.02±0.16 0±0 0.07±0.29 0±0.02 Massilioclostridium 0.02±0.08 0.05±0.11 0±0 0±0.02 JAFGIC01 0.02±0.23 0±0 0±0 0.1±0.46 CALURL01 0.02±0.1 0.02±0.09 0.04±0.13 0.01±0.03 AM-1111 0.02±0.16 0.05±0.23 0±0 0±0 Leadbetterella 0.02±0.12 0.03±0.15 0.03±0.11 0±0 Sulfuritalea 0.02±0.13 0.05±0.19 0±0 0±0 Aquisediminimonas 0.02±0.11 0.05±0.16 0±0 0±0 JAGOBP01 0.02±0.2 0±0 0±0 0.09±0.39 UBA8515 0.02±0.12 0.05±0.18 0±0 0±0 CHH4-2 0.02±0.06 0.01±0.05 0.04±0.07 0.02±0.05 GWF2-50-10 0.02±0.13 0.05±0.2 0±0 0±0 JAGOMW01 0.02±0.18 0.05±0.28 0±0 0±0 Merdenecus 0.02±0.08 0±0.02 0.06±0.14 0.01±0.03 UBA5195 0.02±0.12 0.05±0.18 0±0 0±0 Avimicrobium 0.02±0.04 0.01±0.02 0.02±0.03 0.05±0.05 UBA4417 0.02±0.19 0.05±0.29 0±0 0±0 JACRFF01 0.02±0.1 0.05±0.15 0±0 0±0 UBA3254 0.02±0.13 0.04±0.2 0±0 0±0 Plesiomonas 0.02±0.19 0.04±0.28 0±0 0±0 GWA2-36-10 0.02±0.15 0.04±0.22 0±0 0±0 Serratia_A 0.02±0.11 0.02±0.06 0.04±0.19 0±0 JAAYKM01 0.02±0.18 0±0 0±0 0.08±0.36 RGIG4140 0.02±0.12 0±0 0.03±0.16 0.04±0.18 UBA1794 0.02±0.08 0.01±0.03 0±0 0.07±0.15 PALSA-1004 0.02±0.15 0.04±0.22 0±0 0±0 WRDF01 0.02±0.05 0.01±0.04 0±0.01 0.06±0.09 M0103 0.02±0.12 0±0 0±0 0.07±0.24 Holophaga 0.02±0.18 0±0 0±0 0.07±0.35 MGBC102946 0.02±0.17 0.04±0.26 0±0 0±0 Hepatoplasma 0.02±0.17 0.04±0.26 0±0 0±0 UBA1306 0.02±0.17 0±0 0±0 0.07±0.34 UBA668 0.02±0.12 0.04±0.18 0±0 0±0 JAFGVL01 0.02±0.16 0.04±0.25 0±0 0±0 CAJATL01 0.02±0.1 0.04±0.16 0±0 0±0 Fluviibacter 0.02±0.05 0.03±0.07 0±0 0.02±0.05 CAJBLF01 0.02±0.15 0.04±0.23 0±0 0±0 UBA2192 0.02±0.09 0.02±0.08 0±0 0.03±0.14 Lacibacter 0.01±0.13 0.03±0.2 0±0 0±0 Massiliimalia 0.01±0.06 0.03±0.09 0±0 0±0 CAZU01 0.01±0.07 0±0 0.02±0.09 0.03±0.09 RGDT01 0.01±0.14 0.03±0.21 0±0 0±0 SSEF01 0.01±0.1 0.03±0.16 0±0 0±0 JAKJEI01 0.01±0.11 0.03±0.16 0±0 0±0 Intestinibacillus 0.01±0.05 0.02±0.05 0.01±0.02 0.02±0.06 RGIG8482 0.01±0.08 0.02±0.12 0±0.02 0.01±0.03 CADEED01 0.01±0.08 0.03±0.11 0±0 0±0 JAAZKV01 0.01±0.1 0.03±0.15 0±0 0±0 Morganella 0.01±0.09 0.02±0.13 0.01±0.05 0±0 JAEZVV01 0.01±0.09 0.03±0.14 0±0 0±0 HGM16780 0.01±0.05 0.01±0.03 0.02±0.07 0.01±0.03 JAJQEJ01 0.01±0.04 0±0.01 0.01±0.03 0.02±0.06 JAAYCI01 0.01±0.04 0.02±0.06 0±0 0±0.01 UBA9973 0.01±0.09 0±0 0±0 0.04±0.18 Cardinium 0.01±0.05 0.02±0.07 0±0 0±0 Rahnella 0.01±0.06 0±0 0±0 0.03±0.12 Brevinema 0.01±0.06 0.01±0.04 0.02±0.09 0±0 Polynucleobacter 0.01±0.03 0.01±0.04 0±0 0±0.01 JAGQMS01 0.01±0.03 0.02±0.05 0±0 0±0 Methylopumilus_A 0.01±0.04 0±0 0±0 0.03±0.08 UBA8529 0.01±0.05 0.01±0.07 0±0 0±0 UBA11704 0.01±0.05 0.01±0.07 0±0 0±0 Lumbricidophila 0.01±0.05 0.01±0.08 0±0 0±0 Flavobacterium 0.01±0.05 0.01±0.07 0±0 0±0 UBA10108 0.01±0.05 0±0 0±0 0.02±0.1 Rhodoferax 0±0.03 0±0 0±0 0.02±0.07 Acinetobacter 0±0.04 0±0 0.02±0.06 0±0 C7867-006 0±0.04 0.01±0.06 0±0 0±0 MWCR01 0±0.02 0.01±0.04 0±0 0±0 2-01-FULL-39-10-A 0±0.03 0.01±0.04 0±0 0±0 Aurantimicrobium 0±0.01 0.01±0.02 0±0 0±0.01 Cetobacterium_A 0±0.02 0±0 0.01±0.03 0±0 JACRJP01 0±0.02 0.01±0.03 0±0 0±0 Vogesella 0±0.01 0±0.02 0±0 0±0 genus_summary %&gt;% # left_join(sample_metadata,by=join_by(sample==sample)) %&gt;% mutate(genus=factor(genus, levels=rev(genus_summary_sort %&gt;% pull(genus)))) %&gt;% filter(relabun &gt; 0) %&gt;% ggplot(aes(x=relabun, y=genus, group=genus, color=phylum)) + scale_color_manual(values=phylum_colors) + geom_jitter(alpha=0.5) + facet_grid(.~type)+ theme_minimal() + theme( axis.text = element_text(size=6), )+ labs(y=&quot;Genus&quot;, x=&quot;Relative abundance&quot;, color=&quot;Phylum&quot;) 5.4.2 Per season genus_summary %&gt;% group_by(genus) %&gt;% summarise(total_mean=mean(relabun*100, na.rm=T), total_sd=sd(relabun*100, na.rm=T), spring_mean=mean(relabun[season==&quot;spring&quot;]*100, na.rm=T), spring_sd=sd(relabun[season==&quot;spring&quot;]*100, na.rm=T), autumn_mean=mean(relabun[season==&quot;autumn&quot;]*100, na.rm=T), autumn_sd=sd(relabun[season==&quot;autumn&quot;]*100, na.rm=T)) %&gt;% mutate(total=str_c(round(total_mean,2),&quot;±&quot;,round(total_sd,2)), spring=str_c(round(spring_mean,2),&quot;±&quot;,round(spring_sd,2)), autumn=str_c(round(autumn_mean,2),&quot;±&quot;,round(autumn_sd,2))) %&gt;% arrange(-total_mean) %&gt;% dplyr::select(genus,total,spring,autumn) %&gt;% tt() tinytable_zsl2ydlujpbe2oqh8qca .table td.tinytable_css_aikkz5tjvhzel06ucvzu, .table th.tinytable_css_aikkz5tjvhzel06ucvzu { border-bottom: solid 0.1em #d3d8dc; } genus total spring autumn Bacteroides 17.27±15.59 11.72±8.32 20.24±17.69 Mucinivorans 10.39±12.9 9.74±6.68 10.74±15.26 Parabacteroides 7.07±6.44 6.62±4.73 7.31±7.22 Aeromonas 4.15±10.69 4.36±9.73 4.04±11.25 Mycoplasma_L 3.78±6.81 4.07±4.75 3.63±7.72 Rikenella 2.79±5.08 4.08±5.83 2.11±4.53 JADFUS01 2.22±2.02 2.31±1.62 2.18±2.22 Odoribacter 1.87±2.46 3±2.79 1.27±2.05 Akkermansia 1.63±3.1 3.23±4.43 0.77±1.54 Clostridium 1.41±1.84 1.64±1.83 1.28±1.85 Chlorobaculum 1.26±7.85 0±0 1.93±9.68 UBA866 1.2±2.17 2.2±3.23 0.66±0.96 Parabacteroides_B 1.13±1.58 1.06±1.18 1.16±1.77 Aquirickettsiella 0.99±8.81 0±0 1.52±10.91 Hafnia 0.97±3.83 2.28±5.92 0.27±1.67 Buttiauxella 0.94±4.16 0.09±0.43 1.4±5.1 Mobilisporobacter 0.84±2.27 0.72±1.45 0.9±2.61 Thiodictyon 0.81±3.44 1.64±5.45 0.37±1.44 UMGS1251 0.77±1.13 0.66±0.83 0.82±1.27 Sarcina 0.73±1.94 0.57±1.25 0.81±2.23 Alistipes 0.68±0.97 1.02±0.84 0.5±0.99 FACHB-831 0.68±6.41 0±0 1.05±7.94 Hydrogenoanaerobacterium 0.66±1.76 0.82±1.04 0.58±2.05 Clostridium_Q 0.66±0.78 0.66±0.88 0.65±0.73 SZUA-378 0.57±1.52 1.04±2.3 0.31±0.76 Angelakisella 0.56±0.72 0.83±0.84 0.41±0.61 LD21 0.55±1.87 0.03±0.17 0.83±2.27 Malacoplasma 0.44±1.76 0.29±0.73 0.52±2.12 Tidjanibacter 0.41±0.75 0.31±0.35 0.47±0.89 Hungatella_A 0.4±0.64 0.28±0.61 0.46±0.65 OLB14 0.39±1.69 0±0 0.6±2.06 Budvicia 0.38±1.36 0.27±1.15 0.43±1.47 JAGNZR01 0.35±0.94 0.17±0.38 0.45±1.13 Anaerorhabdus 0.35±1.17 0.37±0.67 0.34±1.37 Anaerotruncus 0.31±0.48 0.25±0.33 0.35±0.55 OM05-12 0.3±0.5 0.4±0.57 0.25±0.45 CAIVKH01 0.3±2.01 0±0 0.46±2.48 Chlorobium 0.26±1.63 0±0 0.4±2.01 RXIV01 0.25±2.33 0.71±3.95 0±0 Gallalistipes 0.25±0.71 0.5±1.13 0.11±0.22 CAKVBE01 0.25±0.69 0.22±0.48 0.26±0.79 Dielma 0.23±0.36 0.29±0.4 0.2±0.33 HGM05232 0.22±0.37 0.46±0.48 0.1±0.21 SHND01 0.21±1.4 0.48±2.27 0.06±0.48 Avirikenella 0.2±0.64 0.24±0.45 0.18±0.73 UBA4132 0.2±1.49 0±0 0.31±1.84 Bilophila 0.2±0.32 0.27±0.36 0.17±0.3 Craterilacuibacter 0.2±1.39 0.57±2.34 0±0 Gallibacteroides 0.2±0.38 0.37±0.53 0.11±0.21 CAJGBR01 0.19±0.26 0.28±0.22 0.15±0.27 Chloroploca 0.19±1.8 0.54±3.06 0±0.01 Lamprocystis 0.18±0.88 0.27±0.97 0.13±0.82 FEN-1139 0.18±1.71 0±0 0.27±2.12 RUG14305 0.18±0.25 0.23±0.29 0.15±0.22 Alistipes_A 0.17±0.32 0.25±0.46 0.13±0.21 Smithella 0.17±1.55 0±0 0.26±1.92 UBA6186 0.17±1.46 0.46±2.47 0.01±0.08 Anaerovorax 0.17±0.32 0.19±0.31 0.15±0.32 Phocea 0.16±0.35 0.33±0.52 0.07±0.18 M3007 0.16±0.89 0±0 0.25±1.09 Romboutsia_D 0.16±0.34 0.28±0.49 0.1±0.21 Cetobacterium 0.16±0.45 0.13±0.33 0.17±0.5 JADLHS01 0.16±0.93 0.22±0.86 0.13±0.97 Scandinavium 0.15±0.85 0.06±0.36 0.19±1.02 Amedibacillus 0.15±0.43 0.03±0.15 0.2±0.51 JAGAJR01 0.14±0.29 0.21±0.29 0.11±0.28 Luteolibacter 0.14±0.53 0±0 0.22±0.65 GCA-2737665 0.13±0.89 0±0 0.2±1.09 Aminipila 0.13±0.18 0.17±0.21 0.11±0.16 CAIQJJ01 0.13±1.22 0±0 0.19±1.51 JADKHC01 0.13±1.2 0±0 0.19±1.49 JJ008 0.12±0.69 0±0 0.19±0.85 Intestinimonas 0.12±0.2 0.11±0.19 0.13±0.2 Citrobacter 0.12±1.12 0.33±1.89 0.01±0.07 Planktothrix 0.12±0.81 0.35±1.35 0±0.01 FEN-1279 0.12±0.81 0±0 0.18±0.99 Harryflintia 0.12±0.32 0.08±0.15 0.13±0.38 UBA5066 0.11±0.78 0.3±1.3 0.02±0.13 JACRCG01 0.11±0.7 0±0 0.18±0.86 Negativibacillus 0.11±0.35 0.16±0.39 0.09±0.33 Rhodoferax_C 0.11±0.86 0.01±0.05 0.16±1.06 CAIPUE01 0.11±0.28 0.15±0.26 0.09±0.29 WRKB01 0.11±0.21 0.15±0.24 0.09±0.2 Anaerotignum 0.1±0.23 0.09±0.21 0.11±0.24 Spyradomonas 0.1±0.3 0.14±0.29 0.08±0.3 TH-plancto1 0.1±0.94 0±0 0.15±1.17 Azonexus 0.09±0.43 0.15±0.63 0.06±0.28 Methanoregula 0.09±0.74 0±0 0.14±0.91 Pseudoflavonifractor 0.09±0.22 0.09±0.23 0.09±0.21 RGIG7389 0.08±0.15 0.15±0.18 0.04±0.11 UBA7488 0.08±0.28 0.21±0.43 0.01±0.08 UBA3961 0.08±0.37 0±0 0.12±0.45 RPPU01 0.08±0.75 0±0 0.12±0.93 RGIG5057 0.07±0.36 0.19±0.58 0.01±0.07 UMGS1202 0.07±0.14 0.16±0.2 0.03±0.06 CAIQQL01 0.07±0.65 0±0 0.11±0.81 Methanothrix 0.07±0.68 0±0 0.11±0.84 Egerieousia 0.07±0.19 0.12±0.24 0.04±0.16 UBA11358 0.07±0.35 0±0 0.11±0.43 IGN3 0.07±0.58 0.02±0.12 0.09±0.72 14-2 0.07±0.32 0.15±0.53 0.02±0.08 SKHV01 0.07±0.63 0±0 0.1±0.78 Butyribacter 0.06±0.61 0±0 0.1±0.76 CAIRTM01 0.06±0.39 0.08±0.37 0.06±0.41 OLB5 0.06±0.35 0±0 0.1±0.43 Methylocystis 0.06±0.28 0±0 0.1±0.35 Robinsoniella 0.06±0.21 0.02±0.07 0.08±0.25 UBA2475 0.06±0.39 0±0 0.09±0.48 JABFSR01 0.06±0.31 0±0 0.09±0.38 Paludibacter 0.06±0.54 0±0 0.09±0.67 Ruthenibacterium 0.06±0.2 0.06±0.23 0.05±0.18 UBA12294 0.06±0.31 0.08±0.46 0.04±0.21 Edwardsiella 0.05±0.17 0.04±0.13 0.06±0.19 CAJAUT01 0.05±0.43 0±0 0.08±0.53 JAKAJH01 0.05±0.39 0±0 0.08±0.48 CAIPTY01 0.05±0.28 0±0 0.08±0.35 Romboutsia_A 0.05±0.26 0.05±0.12 0.05±0.31 Bacteroides_G 0.05±0.25 0.1±0.4 0.03±0.11 Novimethylophilus 0.05±0.29 0±0 0.08±0.35 Vitreimonas 0.05±0.31 0±0 0.08±0.38 Shewanella 0.05±0.22 0±0 0.07±0.26 JAERTD01 0.05±0.37 0.03±0.11 0.06±0.46 JAGPHI01 0.05±0.25 0.01±0.03 0.07±0.31 Aliarcobacter 0.05±0.28 0.04±0.13 0.05±0.34 CAJLXD01 0.05±0.19 0.06±0.12 0.04±0.22 Methyloglobulus 0.05±0.22 0±0 0.07±0.26 JAHHUI01 0.04±0.26 0.12±0.43 0±0.03 Methanocorpusculum 0.04±0.16 0.02±0.05 0.06±0.2 Terracidiphilus 0.04±0.41 0±0 0.07±0.51 Methanobacterium_A 0.04±0.28 0.03±0.11 0.05±0.34 DYRC01 0.04±0.39 0±0 0.06±0.49 JAHHTP01 0.04±0.14 0.08±0.19 0.02±0.1 RGIG5270 0.04±0.22 0±0.01 0.06±0.27 Hylemonella 0.04±0.38 0±0 0.06±0.47 CALXSC01 0.04±0.22 0.05±0.22 0.04±0.21 Eubacterium_R 0.04±0.38 0±0 0.06±0.47 Scatenecus 0.04±0.15 0.02±0.09 0.05±0.18 Copranaerobaculum 0.04±0.16 0.01±0.04 0.06±0.19 RFTN01 0.04±0.22 0±0 0.06±0.27 JAEUNJ01 0.04±0.15 0±0 0.06±0.19 OLB17 0.04±0.24 0.09±0.4 0.01±0.07 Aureliella 0.04±0.29 0±0 0.06±0.36 FEN-979 0.04±0.21 0±0 0.06±0.25 Draconibacterium 0.04±0.16 0±0 0.05±0.19 UBA6024 0.03±0.21 0±0 0.05±0.25 Hespellia 0.03±0.19 0.02±0.06 0.04±0.23 Evtepia 0.03±0.06 0.06±0.08 0.02±0.04 Ferruginibacter 0.03±0.15 0±0 0.05±0.18 JAJBUQ01 0.03±0.06 0.04±0.07 0.02±0.06 Anaerobium 0.03±0.1 0.01±0.03 0.04±0.12 SHXO01 0.03±0.14 0±0 0.04±0.18 Bacilliculturomica 0.03±0.06 0.04±0.08 0.02±0.05 PALSA-1444 0.03±0.14 0±0 0.04±0.18 MGBC133411 0.03±0.16 0.07±0.26 0±0.02 2-12-FULL-35-15 0.03±0.22 0±0 0.04±0.27 Aestuariivirga 0.03±0.11 0±0 0.04±0.14 Syntrophorhabdus 0.03±0.2 0±0 0.04±0.25 Limnohabitans 0.03±0.16 0±0 0.04±0.2 JAAYQI01 0.03±0.1 0.05±0.14 0.01±0.06 IOR16 0.03±0.05 0.03±0.05 0.02±0.06 Coprobacillus 0.02±0.07 0.01±0.04 0.03±0.08 UBA5026 0.02±0.16 0.07±0.27 0±0.01 Massilioclostridium 0.02±0.08 0±0.02 0.03±0.09 JAFGIC01 0.02±0.23 0±0 0.04±0.28 CALURL01 0.02±0.1 0.04±0.13 0.01±0.07 AM-1111 0.02±0.16 0±0 0.04±0.19 Leadbetterella 0.02±0.12 0.02±0.1 0.03±0.13 Sulfuritalea 0.02±0.13 0±0 0.04±0.16 Aquisediminimonas 0.02±0.11 0±0 0.04±0.13 JAGOBP01 0.02±0.2 0±0 0.03±0.24 UBA8515 0.02±0.12 0±0 0.03±0.15 CHH4-2 0.02±0.06 0.02±0.04 0.02±0.07 GWF2-50-10 0.02±0.13 0±0 0.03±0.16 JAGOMW01 0.02±0.18 0±0 0.03±0.23 Merdenecus 0.02±0.08 0.02±0.04 0.02±0.1 UBA5195 0.02±0.12 0±0 0.03±0.15 Avimicrobium 0.02±0.04 0.03±0.05 0.02±0.03 UBA4417 0.02±0.19 0±0 0.03±0.24 JACRFF01 0.02±0.1 0±0 0.03±0.12 UBA3254 0.02±0.13 0±0 0.03±0.16 Plesiomonas 0.02±0.19 0.06±0.32 0±0 GWA2-36-10 0.02±0.15 0±0 0.03±0.18 Serratia_A 0.02±0.11 0.06±0.19 0±0 JAAYKM01 0.02±0.18 0±0 0.03±0.23 RGIG4140 0.02±0.12 0.03±0.15 0.02±0.11 UBA1794 0.02±0.08 0.04±0.13 0±0.02 PALSA-1004 0.02±0.15 0±0 0.03±0.18 WRDF01 0.02±0.05 0.01±0.04 0.02±0.06 M0103 0.02±0.12 0±0 0.03±0.15 Holophaga 0.02±0.18 0±0 0.03±0.22 MGBC102946 0.02±0.17 0.05±0.29 0±0 Hepatoplasma 0.02±0.17 0±0 0.03±0.21 UBA1306 0.02±0.17 0±0 0.03±0.21 UBA668 0.02±0.12 0±0 0.03±0.15 JAFGVL01 0.02±0.16 0±0 0.03±0.2 CAJATL01 0.02±0.1 0±0 0.03±0.13 Fluviibacter 0.02±0.05 0±0 0.02±0.06 CAJBLF01 0.02±0.15 0±0 0.02±0.18 UBA2192 0.02±0.09 0.01±0.03 0.02±0.1 Lacibacter 0.01±0.13 0±0 0.02±0.16 Massiliimalia 0.01±0.06 0±0.01 0.02±0.07 CAZU01 0.01±0.07 0.02±0.09 0.01±0.05 RGDT01 0.01±0.14 0±0 0.02±0.17 SSEF01 0.01±0.1 0±0 0.02±0.13 JAKJEI01 0.01±0.11 0±0 0.02±0.13 Intestinibacillus 0.01±0.05 0±0.01 0.02±0.06 RGIG8482 0.01±0.08 0.03±0.13 0±0.02 CADEED01 0.01±0.08 0±0 0.02±0.09 JAAZKV01 0.01±0.1 0±0 0.02±0.12 Morganella 0.01±0.09 0±0 0.02±0.11 JAEZVV01 0.01±0.09 0.03±0.16 0±0 HGM16780 0.01±0.05 0.01±0.05 0.01±0.05 JAJQEJ01 0.01±0.04 0.03±0.06 0±0.01 JAAYCI01 0.01±0.04 0.01±0.04 0.01±0.04 UBA9973 0.01±0.09 0±0 0.01±0.11 Cardinium 0.01±0.05 0±0 0.01±0.06 Rahnella 0.01±0.06 0±0 0.01±0.07 Brevinema 0.01±0.06 0.01±0.04 0.01±0.07 Polynucleobacter 0.01±0.03 0±0 0.01±0.04 JAGQMS01 0.01±0.03 0±0 0.01±0.04 Methylopumilus_A 0.01±0.04 0±0 0.01±0.05 UBA8529 0.01±0.05 0±0 0.01±0.06 UBA11704 0.01±0.05 0±0 0.01±0.06 Lumbricidophila 0.01±0.05 0±0 0.01±0.07 Flavobacterium 0.01±0.05 0±0 0.01±0.06 UBA10108 0.01±0.05 0±0 0.01±0.06 Rhodoferax 0±0.03 0±0 0.01±0.04 Acinetobacter 0±0.04 0±0 0.01±0.04 C7867-006 0±0.04 0±0 0.01±0.05 MWCR01 0±0.02 0±0 0.01±0.03 2-01-FULL-39-10-A 0±0.03 0±0 0.01±0.04 Aurantimicrobium 0±0.01 0±0 0±0.02 Cetobacterium_A 0±0.02 0.01±0.03 0±0 JACRJP01 0±0.02 0±0 0±0.02 Vogesella 0±0.01 0±0.02 0±0 genus_summary_sort &lt;- genus_summary %&gt;% group_by(genus) %&gt;% summarise(mean=mean(relabun, na.rm=T),sd=sd(relabun, na.rm=T)) %&gt;% arrange(-mean) genus_summary %&gt;% # left_join(sample_metadata,by=join_by(sample==sample)) %&gt;% mutate(genus=factor(genus, levels=rev(genus_summary_sort %&gt;% pull(genus)))) %&gt;% filter(relabun &gt; 0) %&gt;% ggplot(aes(x=relabun, y=genus, group=genus, color=phylum)) + scale_color_manual(values=phylum_colors) + geom_jitter(alpha=0.5) + facet_grid(.~season)+ theme_minimal() + theme( axis.text = element_text(size=6), )+ labs(y=&quot;Genus&quot;, x=&quot;Relative abundance&quot;, color=&quot;Phylum&quot;) 5.5 Archaea 9 5.5.1 Diversity sample richness neutral phylogenetic functional 1 EHI02583 2 1.996870 2.348233 1.279113 2 EHI02588 1 1.000000 1.000000 1.000000 3 EHI02643 1 1.000000 1.000000 1.000000 4 EHI02593 2 1.328193 1.409535 1.220665 5 EHI01585 1 1.000000 1.000000 1.000000 6 EHI02608 1 1.000000 1.000000 1.000000 7 EHI02611 1 1.000000 1.000000 1.000000 8 EHI02641 1 1.000000 1.000000 1.000000 9 EHI02571 2 1.139191 1.235919 1.081231 10 EHI02620 1 1.000000 1.000000 1.000000 11 EHI01449 1 1.000000 1.000000 1.000000 12 EHI02609 1 1.000000 1.000000 1.000000 13 EHI02572 3 2.112285 1.493212 1.293984 14 EHI01613 1 1.000000 1.000000 1.000000 15 EHI01618 1 1.000000 1.000000 1.000000 16 EHI01447 1 1.000000 1.000000 1.000000 17 EHI01627 1 1.000000 1.000000 1.000000 18 EHI02642 2 1.473791 1.756593 1.120537 19 EHI02646 4 2.604054 1.431005 1.596528 20 EHI02109 1 1.000000 1.000000 1.000000 21 EHI02579 1 1.000000 1.000000 1.000000 22 EHI02599 1 1.000000 1.000000 1.000000 23 EHI01628 1 1.000000 1.000000 1.000000 24 EHI01611 2 1.998461 1.563175 1.560517 25 EHI02637 1 1.000000 1.000000 1.000000 26 EHI01443 1 1.000000 1.000000 1.000000 27 EHI02638 3 1.730503 1.722158 1.387103 28 EHI02595 1 1.000000 1.000000 1.000000 29 EHI02574 1 1.000000 1.000000 1.000000 30 EHI02629 1 1.000000 1.000000 1.000000 31 EHI02631 1 1.000000 1.000000 1.000000 32 EHI02621 2 1.962914 1.943525 1.738397 33 EHI01442 2 1.989078 1.562265 1.554603 34 EHI02601 1 1.000000 1.000000 1.000000 35 EHI01438 NA NA NA 1.000000 36 EHI01612 NA NA NA 1.000000 37 EHI02095 NA NA NA 1.000000 38 EHI02596 NA NA NA 1.000000 39 EHI02635 NA NA NA 1.000000 40 EHI02104 NA NA NA 1.000000 41 EHI01631 NA NA NA 1.000000 42 EHI02597 NA NA NA 1.000000 43 EHI01450 NA NA NA 1.000000 44 EHI01610 NA NA NA 1.000000 45 EHI01436 NA NA NA 1.000000 46 EHI01437 NA NA NA 1.000000 47 EHI01440 NA NA NA 1.000000 48 EHI02586 NA NA NA 1.000000 49 EHI02628 NA NA NA 1.000000 50 EHI01451 NA NA NA 1.000000 51 EHI02591 NA NA NA 1.000000 52 EHI02581 NA NA NA 1.000000 53 EHI02115 NA NA NA 1.000000 54 EHI01619 NA NA NA 1.000000 55 EHI02610 NA NA NA 1.000000 56 EHI01439 NA NA NA 1.000000 57 EHI02128 NA NA NA 1.000000 58 EHI01617 NA NA NA 1.000000 59 EHI02626 NA NA NA 1.000000 60 EHI01620 NA NA NA 1.000000 61 EHI02606 NA NA NA 1.000000 62 EHI02604 NA NA NA 1.000000 63 EHI01444 NA NA NA 1.000000 64 EHI02085 NA NA NA 1.000000 65 EHI02616 NA NA NA 1.000000 66 EHI02594 NA NA NA 1.000000 67 EHI02613 NA NA NA 1.000000 68 EHI01625 NA NA NA 1.000000 69 EHI01448 NA NA NA 1.000000 70 EHI02589 NA NA NA 1.000000 71 EHI01623 NA NA NA 1.000000 72 EHI02634 NA NA NA 1.000000 73 EHI02640 NA NA NA 1.000000 74 EHI02636 NA NA NA 1.000000 75 EHI02578 NA NA NA 1.000000 76 EHI01616 NA NA NA 1.000000 77 EHI01584 NA NA NA 1.000000 78 EHI01445 NA NA NA 1.000000 79 EHI02622 NA NA NA 1.000000 80 EHI02614 NA NA NA 1.000000 81 EHI02580 NA NA NA 1.000000 82 EHI02627 NA NA NA 1.000000 83 EHI02618 NA NA NA 1.000000 84 EHI01441 NA NA NA 1.000000 85 EHI02605 NA NA NA 1.000000 86 EHI02573 NA NA NA 1.000000 87 EHI02577 NA NA NA 1.000000 88 EHI02576 NA NA NA 1.000000 89 EHI02623 NA NA NA 1.000000 90 EHI02600 NA NA NA 1.000000 91 EHI01621 NA NA NA 1.000000 92 EHI02575 NA NA NA 1.000000 5.5.1.1 Richness 5.5.1.2 Neutral 5.5.1.3 Phylogenetic "],["alpha-diversity.html", "Chapter 6 Alpha diversity 6.1 Types of pond 6.2 Season", " Chapter 6 Alpha diversity load(&quot;data/data.Rdata&quot;) load(&quot;data/data_filtdamr_80.Rdata&quot;) sample_metadata &lt;- sample_metadata_filtdamr genome_counts_filt &lt;- genome_counts_filtdamr genome_metadata &lt;- genome_metadata_filtdamr genome_tree &lt;- genome_tree_filtdamr genome_gifts &lt;- genome_gifts_filtdamr phylum_colors &lt;- phylum_colors_filtdamr # Calculate Hill numbers richness &lt;- genome_counts_filt %&gt;% column_to_rownames(var = &quot;genome&quot;) %&gt;% dplyr::select(where(~ !all(. == 0))) %&gt;% hilldiv(., q = 0) %&gt;% t() %&gt;% as.data.frame() %&gt;% dplyr::rename(richness = 1) %&gt;% rownames_to_column(var = &quot;sample&quot;) neutral &lt;- genome_counts_filt %&gt;% column_to_rownames(var = &quot;genome&quot;) %&gt;% dplyr::select(where(~ !all(. == 0))) %&gt;% hilldiv(., q = 1) %&gt;% t() %&gt;% as.data.frame() %&gt;% dplyr::rename(neutral = 1) %&gt;% rownames_to_column(var = &quot;sample&quot;) phylogenetic &lt;- genome_counts_filt %&gt;% column_to_rownames(var = &quot;genome&quot;) %&gt;% dplyr::select(where(~ !all(. == 0))) %&gt;% hilldiv(., q = 1, tree = genome_tree) %&gt;% t() %&gt;% as.data.frame() %&gt;% dplyr::rename(phylogenetic = 1) %&gt;% rownames_to_column(var = &quot;sample&quot;) # Aggregate basal GIFT into elements dist &lt;- genome_gifts %&gt;% to.elements(., GIFT_db) %&gt;% traits2dist(., method = &quot;gower&quot;) functional &lt;- genome_counts_filt %&gt;% filter(genome %in% rownames(dist)) %&gt;% column_to_rownames(var = &quot;genome&quot;) %&gt;% dplyr::select(where(~ !all(. == 0))) %&gt;% hilldiv(., q = 1, dist = dist) %&gt;% t() %&gt;% as.data.frame() %&gt;% dplyr::rename(functional = 1) %&gt;% rownames_to_column(var = &quot;sample&quot;) %&gt;% mutate(functional = if_else(is.nan(functional), 1, functional)) # Merge all metrics alpha_div &lt;- richness %&gt;% full_join(neutral, by = join_by(sample == sample)) %&gt;% full_join(phylogenetic, by = join_by(sample == sample)) %&gt;% full_join(functional, by = join_by(sample == sample)) # sample_metadata_div &lt;- sample_metadata %&gt;% # left_join(alpha_div, by = join_by(sample == sample)) # # write_csv(sample_metadata_div, &quot;data/sample_metadata_div.csv&quot;) 6.1 Types of pond tinytable_78ucjwdzasz12dpxhsed .table td.tinytable_css_4ucqp071m380728rjp0h, .table th.tinytable_css_4ucqp071m380728rjp0h { border-bottom: solid 0.1em #d3d8dc; } alpha natural protected urban richness 171.77±54.93 173.21±62.45 235.14±67.21 neutral 71.91±33.14 71.72±31.17 105.71±50.13 phylogenetic 5.74±1.82 4.97±1.52 5.91±1.49 functional 1.51±0.11 1.53±0.07 1.53±0.04 6.1.1 Mixed models Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;] Family: Negative Binomial(8.0088) ( log ) Formula: richness ~ type + (1 | region) Data: alpha_div_meta AIC BIC logLik deviance df.resid 849.9 861.5 -420.0 839.9 70 Scaled residuals: Min 1Q Median 3Q Max -2.36361 -0.62629 0.08429 0.51695 1.99337 Random effects: Groups Name Variance Std.Dev. region (Intercept) 6.927e-12 2.632e-06 Number of obs: 75, groups: region, 9 Fixed effects: Estimate Std. Error z value Pr(&gt;|z|) (Intercept) 5.146135 0.066001 77.970 &lt; 2e-16 *** typeprotected 0.008357 0.098992 0.084 0.93272 typeurban 0.314058 0.102491 3.064 0.00218 ** --- Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 Correlation of Fixed Effects: (Intr) typprt typeprotctd -0.667 typeurban -0.644 0.429 optimizer (Nelder_Mead) convergence code: 0 (OK) boundary (singular) fit: see help(&#39;isSingular&#39;) $emmeans type emmean SE df asymp.LCL asymp.UCL natural 5.15 0.0660 Inf 5.02 5.28 protected 5.15 0.0738 Inf 5.01 5.30 urban 5.46 0.0784 Inf 5.31 5.61 Results are given on the log (not the response) scale. Confidence level used: 0.95 $contrasts contrast estimate SE df z.ratio p.value natural - protected -0.00836 0.099 Inf -0.084 0.9961 natural - urban -0.31406 0.102 Inf -3.064 0.0062 protected - urban -0.30570 0.108 Inf -2.839 0.0126 Results are given on the log (not the response) scale. P value adjustment: tukey method for comparing a family of 3 estimates Linear mixed-effects model fit by REML Data: alpha_div_meta AIC BIC logLik 746.4498 757.8332 -368.2249 Random effects: Formula: ~1 | region (Intercept) Residual StdDev: 12.45724 36.71365 Fixed effects: neutral ~ type Value Std.Error DF t-value p-value (Intercept) 70.28244 9.523527 66 7.379875 0.0000 typeprotected 1.63653 14.236961 6 0.114949 0.9122 typeurban 33.16613 15.314356 6 2.165689 0.0735 Correlation: (Intr) typprt typeprotected -0.669 typeurban -0.622 0.416 Standardized Within-Group Residuals: Min Q1 Med Q3 Max -2.66775476 -0.71161839 -0.00119275 0.62430358 1.92566677 Number of Observations: 75 Number of Groups: 9 $emmeans type emmean SE df lower.CL upper.CL natural 70.3 9.52 8 48.3 92.2 protected 71.9 10.58 6 46.0 97.8 urban 103.4 11.99 6 74.1 132.8 Degrees-of-freedom method: containment Confidence level used: 0.95 $contrasts contrast estimate SE df t.ratio p.value natural - protected -1.64 14.2 6 -0.115 0.9928 natural - urban -33.17 15.3 6 -2.166 0.1564 protected - urban -31.53 16.0 6 -1.971 0.2001 Degrees-of-freedom method: containment P value adjustment: tukey method for comparing a family of 3 estimates Linear mixed-effects model fit by REML Data: alpha_div_meta AIC BIC logLik 295.1656 306.5489 -142.5828 Random effects: Formula: ~1 | region (Intercept) Residual StdDev: 0.1228795 1.63691 Fixed effects: phylogenetic ~ type Value Std.Error DF t-value p-value (Intercept) 5.755145 0.3066863 66 18.765578 0.0000 typeprotected -0.781782 0.4597242 6 -1.700547 0.1399 typeurban 0.148035 0.4791718 6 0.308940 0.7678 Correlation: (Intr) typprt typeprotected -0.667 typeurban -0.640 0.427 Standardized Within-Group Residuals: Min Q1 Med Q3 Max -2.6588881 -0.8153911 0.1724470 0.7624668 2.0024050 Number of Observations: 75 Number of Groups: 9 $emmeans type emmean SE df lower.CL upper.CL natural 5.76 0.307 8 5.05 6.46 protected 4.97 0.342 6 4.14 5.81 urban 5.90 0.368 6 5.00 6.80 Degrees-of-freedom method: containment Confidence level used: 0.95 $contrasts contrast estimate SE df t.ratio p.value natural - protected 0.782 0.460 6 1.701 0.2799 natural - urban -0.148 0.479 6 -0.309 0.9492 protected - urban -0.930 0.503 6 -1.849 0.2331 Degrees-of-freedom method: containment P value adjustment: tukey method for comparing a family of 3 estimates Linear mixed-effects model fit by REML Data: alpha_div_meta AIC BIC logLik -136.0908 -124.7075 73.04542 Random effects: Formula: ~1 | region (Intercept) Residual StdDev: 0.03472027 0.07915186 Fixed effects: functional ~ type Value Std.Error DF t-value p-value (Intercept) 1.5169056 0.02357202 66 64.35197 0.0000 typeprotected 0.0240562 0.03527201 6 0.68202 0.5207 typeurban 0.0146110 0.03832077 6 0.38128 0.7161 Correlation: (Intr) typprt typeprotected -0.668 typeurban -0.615 0.411 Standardized Within-Group Residuals: Min Q1 Med Q3 Max -4.74908675 -0.52425961 -0.08333887 0.38109519 3.29348555 Number of Observations: 75 Number of Groups: 9 $emmeans type emmean SE df lower.CL upper.CL natural 1.52 0.0236 8 1.46 1.57 protected 1.54 0.0262 6 1.48 1.61 urban 1.53 0.0302 6 1.46 1.61 Degrees-of-freedom method: containment Confidence level used: 0.95 $contrasts contrast estimate SE df t.ratio p.value natural - protected -0.02406 0.0353 6 -0.682 0.7821 natural - urban -0.01461 0.0383 6 -0.381 0.9240 protected - urban 0.00945 0.0400 6 0.236 0.9699 Degrees-of-freedom method: containment P value adjustment: tukey method for comparing a family of 3 estimates 6.2 Season tinytable_3d96m6a1tb7k8tb6e8hd .table td.tinytable_css_plk4py10np03z66sbiya, .table th.tinytable_css_plk4py10np03z66sbiya { border-bottom: solid 0.1em #d3d8dc; } alpha spring autumn richness 212.31±58.99 175.89±67.67 neutral 93.96±39.44 73.34±39.64 phylogenetic 6.44±1.12 4.97±1.71 functional 1.57±0.07 1.5±0.08 6.2.1 Mixed models Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;] Family: Negative Binomial(8.412) ( log ) Formula: richness ~ season + (1 | region) Data: alpha_div_meta AIC BIC logLik deviance df.resid 785.2 794.1 -388.6 777.2 65 Scaled residuals: Min 1Q Median 3Q Max -2.3274 -0.5061 0.0599 0.5022 1.8300 Random effects: Groups Name Variance Std.Dev. region (Intercept) 0.02351 0.1533 Number of obs: 69, groups: region, 7 Fixed effects: Estimate Std. Error z value Pr(&gt;|z|) (Intercept) 5.36426 0.09166 58.52 &lt; 2e-16 *** seasonautumn -0.24022 0.09205 -2.61 0.00906 ** --- Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 Correlation of Fixed Effects: (Intr) seasonautmn -0.604 Linear mixed-effects model fit by REML Data: alpha_div_meta AIC BIC logLik 690.583 699.4018 -341.2915 Random effects: Formula: ~1 | region (Intercept) Residual StdDev: 22.26804 34.87609 Fixed effects: neutral ~ season Value Std.Error DF t-value p-value (Intercept) 96.41332 10.95892 61 8.797703 0.0000 seasonautumn -28.49738 8.96567 61 -3.178499 0.0023 Correlation: (Intr) seasonautumn -0.507 Standardized Within-Group Residuals: Min Q1 Med Q3 Max -2.5447837 -0.6508437 -0.0542637 0.7201334 2.2906571 Number of Observations: 69 Number of Groups: 7 Linear mixed-effects model fit by REML Data: alpha_div_meta AIC BIC logLik 254.7091 263.5279 -123.3546 Random effects: Formula: ~1 | region (Intercept) Residual StdDev: 0.3464591 1.418543 Fixed effects: phylogenetic ~ season Value Std.Error DF t-value p-value (Intercept) 6.517310 0.3131961 61 20.809038 0 seasonautumn -1.706611 0.3590981 61 -4.752491 0 Correlation: (Intr) seasonautumn -0.723 Standardized Within-Group Residuals: Min Q1 Med Q3 Max -2.4294605 -0.6316590 -0.1483263 0.6510432 2.5991944 Number of Observations: 69 Number of Groups: 7 Linear mixed-effects model fit by REML Data: alpha_div_meta AIC BIC logLik -138.7388 -129.92 73.3694 Random effects: Formula: ~1 | region (Intercept) Residual StdDev: 0.01083526 0.07621117 Fixed effects: functional ~ season Value Std.Error DF t-value p-value (Intercept) 1.5572483 0.01580131 61 98.55186 0.000 seasonautumn -0.0592489 0.01917483 61 -3.08993 0.003 Correlation: (Intr) seasonautumn -0.77 Standardized Within-Group Residuals: Min Q1 Med Q3 Max -4.2918149 -0.4671337 -0.1510043 0.4405900 3.2836568 Number of Observations: 69 Number of Groups: 7 "],["beta-diversity.html", "Chapter 7 Beta diversity 7.1 Permanova analysis 7.2 Beta diversity plots", " Chapter 7 Beta diversity load(&quot;data/data.Rdata&quot;) load(&quot;data/beta.Rdata&quot;) load(&quot;data/data_filtdamr_80.Rdata&quot;) load(&quot;data/beta_filtdamr_80.Rdata&quot;) sample_metadata &lt;- sample_metadata_filtdamr genome_counts_filt &lt;- genome_counts_filtdamr genome_metadata &lt;- genome_metadata_filtdamr genome_tree &lt;- genome_tree_filtdamr genome_gifts &lt;- genome_gifts_filtdamr phylum_colors &lt;- phylum_colors_filtdamr beta_q0n &lt;- genome_counts_filt %&gt;% column_to_rownames(., &quot;genome&quot;) %&gt;% filter(rowSums(. != 0, na.rm = TRUE) &gt; 0) %&gt;% select_if(~!all(. == 0)) %&gt;% hillpair(., q = 0) beta_q1n &lt;- genome_counts_filt %&gt;% column_to_rownames(., &quot;genome&quot;) %&gt;% filter(rowSums(. != 0, na.rm = TRUE) &gt; 0) %&gt;% select_if(~!all(. == 0)) %&gt;% hillpair(., q = 1) beta_q1p &lt;- genome_counts_filt %&gt;% column_to_rownames(., &quot;genome&quot;) %&gt;% filter(rowSums(. != 0, na.rm = TRUE) &gt; 0) %&gt;% select_if(~!all(. == 0)) %&gt;% hillpair(., q = 1, tree = genome_tree) genome_counts_filt_func &lt;- genome_counts_filt[genome_counts_filt$genome %in% rownames(genome_gifts),] genome_counts_filt_func &lt;- genome_counts_filt[genome_counts_filt$genome %in% rownames(genome_gifts),] dist &lt;- genome_gifts %&gt;% to.elements(., GIFT_db) %&gt;% traits2dist(., method = &quot;gower&quot;) beta_q1f &lt;- genome_counts_filt_func %&gt;% column_to_rownames(., &quot;genome&quot;) %&gt;% filter(rowSums(. != 0, na.rm = TRUE) &gt; 0) %&gt;% select_if(~!all(. == 0)) %&gt;% hillpair(., q = 1, dist = dist) 7.1 Permanova analysis 7.1.1 Strata Richness sample_metadata_row&lt;- column_to_rownames(sample_metadata, &quot;sample&quot;) sample_metadata_row &lt;- sample_metadata_row[labels(beta_q0n$S), ] betadisper(beta_q0n$S, sample_metadata$type) %&gt;% permutest(., pairwise = TRUE) Permutation test for homogeneity of multivariate dispersions Permutation: free Number of permutations: 999 Response: Distances Df Sum Sq Mean Sq F N.Perm Pr(&gt;F) Groups 2 0.03602 0.0180094 2.9837 999 0.061 . Residuals 72 0.43459 0.0060359 --- Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 Pairwise comparisons: (Observed p-value below diagonal, permuted p-value above diagonal) natural protected urban natural 0.737000 0.048 protected 0.724845 0.023 urban 0.044422 0.021094 adonis2(beta_q0n$S ~ type*season, data = sample_metadata %&gt;% arrange(match(sample,labels(beta_q0n$S))), permutations = 999, strata = sample_metadata %&gt;% arrange(match(sample,labels(beta_q0n$S))) %&gt;% pull(region)) %&gt;% broom::tidy() %&gt;% tt() tinytable_u3cbkg103dx1abrufe5f .table td.tinytable_css_wvgth1nfnmzfhym8rwdf, .table th.tinytable_css_wvgth1nfnmzfhym8rwdf { border-bottom: solid 0.1em #d3d8dc; } term df SumOfSqs R2 statistic p.value type 2 2.4713937 0.09990627 4.204275 0.001 season 1 1.0483711 0.04238048 3.566927 0.001 type:season 2 0.9372685 0.03788915 1.594459 0.008 Residual 69 20.2800898 0.81982411 NA NA Total 74 24.7371231 1.00000000 NA NA pairwise.adonis2(beta_q0n$S ~ type*season, data=sample_metadata_row, perm = 999, strata = &quot;region&quot;) $parent_call [1] &quot;beta_q0n$S ~ type * season , strata = region , permutations 999&quot; $natural_vs_protected Df SumOfSqs R2 F Pr(&gt;F) type 1 1.4635 0.08006 4.7898 0.001 *** season 1 0.9775 0.05347 3.1991 0.001 *** type:season 1 0.5610 0.03069 1.8360 0.008 ** Residual 50 15.2773 0.83577 Total 53 18.2792 1.00000 --- Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 $natural_vs_urban Df SumOfSqs R2 F Pr(&gt;F) type 1 1.2906 0.07930 4.3514 0.001 *** season 1 0.6345 0.03899 2.1392 0.001 *** type:season 1 0.4088 0.02512 1.3785 0.022 * Residual 47 13.9396 0.85658 Total 50 16.2735 1.00000 --- Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 $protected_vs_urban Df SumOfSqs R2 F Pr(&gt;F) type 1 0.9002 0.06603 3.2536 0.001 *** season 1 0.9641 0.07072 3.4846 0.001 *** type:season 1 0.4255 0.03121 1.5378 0.039 * Residual 41 11.3433 0.83205 Total 44 13.6329 1.00000 --- Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 attr(,&quot;class&quot;) [1] &quot;pwadstrata&quot; &quot;list&quot; Neutral betadisper(beta_q1n$S, sample_metadata$type) %&gt;% permutest(., pairwise = TRUE) Permutation test for homogeneity of multivariate dispersions Permutation: free Number of permutations: 999 Response: Distances Df Sum Sq Mean Sq F N.Perm Pr(&gt;F) Groups 2 0.09096 0.045478 5.7232 999 0.003 ** Residuals 72 0.57213 0.007946 --- Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 Pairwise comparisons: (Observed p-value below diagonal, permuted p-value above diagonal) natural protected urban natural 0.0110000 0.005 protected 0.0102235 0.754 urban 0.0046867 0.7844374 adonis2(beta_q1n$S ~ type*season, data = sample_metadata %&gt;% arrange(match(sample,labels(beta_q1n$S))), permutations = 999, strata = sample_metadata %&gt;% arrange(match(sample,labels(beta_q1n$S))) %&gt;% pull(region)) %&gt;% broom::tidy() %&gt;% tt() tinytable_5tojwmooc5hn9xch4hfr .table td.tinytable_css_j5srotkk62n0slxbosor, .table th.tinytable_css_j5srotkk62n0slxbosor { border-bottom: solid 0.1em #d3d8dc; } term df SumOfSqs R2 statistic p.value type 2 2.8331097 0.12162688 5.312689 0.001 season 1 1.1483346 0.04929861 4.306748 0.001 type:season 2 0.9141128 0.03924334 1.714158 0.014 Residual 69 18.3978927 0.78983117 NA NA Total 74 23.2934498 1.00000000 NA NA pairwise.adonis2(beta_q1n$S ~ type*season, data=sample_metadata_row, perm = 999, strata = &quot;region&quot;) $parent_call [1] &quot;beta_q1n$S ~ type * season , strata = region , permutations 999&quot; $natural_vs_protected Df SumOfSqs R2 F Pr(&gt;F) type 1 1.8601 0.10743 6.7297 0.001 *** season 1 1.0323 0.05962 3.7349 0.001 *** type:season 1 0.6017 0.03475 2.1770 0.005 ** Residual 50 13.8200 0.79819 Total 53 17.3142 1.00000 --- Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 $natural_vs_urban Df SumOfSqs R2 F Pr(&gt;F) type 1 1.4101 0.08840 4.9486 0.001 *** season 1 0.7465 0.04680 2.6197 0.001 *** type:season 1 0.4017 0.02518 1.4097 0.050 * Residual 47 13.3922 0.83962 Total 50 15.9504 1.00000 --- Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 $protected_vs_urban Df SumOfSqs R2 F Pr(&gt;F) type 1 0.8917 0.07545 3.8147 0.001 *** season 1 0.9941 0.08412 4.2528 0.001 *** type:season 1 0.3486 0.02950 1.4915 0.107 Residual 41 9.5836 0.81093 Total 44 11.8179 1.00000 --- Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 attr(,&quot;class&quot;) [1] &quot;pwadstrata&quot; &quot;list&quot; Phylogenetic betadisper(beta_q1p$S, sample_metadata$type) %&gt;% permutest(., pairwise = TRUE) Permutation test for homogeneity of multivariate dispersions Permutation: free Number of permutations: 999 Response: Distances Df Sum Sq Mean Sq F N.Perm Pr(&gt;F) Groups 2 0.05728 0.028642 2.661 999 0.082 . Residuals 72 0.77498 0.010764 --- Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 Pairwise comparisons: (Observed p-value below diagonal, permuted p-value above diagonal) natural protected urban natural 0.043000 0.105 protected 0.059462 0.970 urban 0.111009 0.951525 adonis2(beta_q1p$S ~ type*season, data = sample_metadata %&gt;% arrange(match(sample,labels(beta_q1p$S))), permutations = 999, strata = sample_metadata %&gt;% arrange(match(sample,labels(beta_q1p$S))) %&gt;% pull(region)) %&gt;% broom::tidy() %&gt;% tt() tinytable_l6g466y1m3wp5wlcsq34 .table td.tinytable_css_v9c38gwbizavvqoa7yom, .table th.tinytable_css_v9c38gwbizavvqoa7yom { border-bottom: solid 0.1em #d3d8dc; } term df SumOfSqs R2 statistic p.value type 2 0.3561228 0.09721296 4.088057 0.015 season 1 0.1880028 0.05132022 4.316297 0.001 type:season 2 0.1138033 0.03106555 1.306387 0.236 Residual 69 3.0053980 0.82040127 NA NA Total 74 3.6633269 1.00000000 NA NA pairwise.adonis2(beta_q1p$S ~ type*season, data=sample_metadata_row, perm = 999, strata = &quot;region&quot;) $parent_call [1] &quot;beta_q1p$S ~ type * season , strata = region , permutations 999&quot; $natural_vs_protected Df SumOfSqs R2 F Pr(&gt;F) type 1 0.29577 0.10235 6.3336 0.012 * season 1 0.19224 0.06652 4.1165 0.002 ** type:season 1 0.06695 0.02317 1.4337 0.212 Residual 50 2.33495 0.80797 Total 53 2.88992 1.00000 --- Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 $natural_vs_urban Df SumOfSqs R2 F Pr(&gt;F) type 1 0.12582 0.04567 2.3870 0.224 season 1 0.09019 0.03274 1.7110 0.163 type:season 1 0.06174 0.02241 1.1713 0.369 Residual 47 2.47750 0.89919 Total 50 2.75526 1.00000 $protected_vs_urban Df SumOfSqs R2 F Pr(&gt;F) type 1 0.09601 0.06457 3.2849 0.002 ** season 1 0.15237 0.10248 5.2131 0.001 *** type:season 1 0.04012 0.02698 1.3727 0.248 Residual 41 1.19834 0.80597 Total 44 1.48684 1.00000 --- Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 attr(,&quot;class&quot;) [1] &quot;pwadstrata&quot; &quot;list&quot; Functional betadisper(beta_q1f$S, sample_metadata$type) %&gt;% permutest(., pairwise = TRUE) Permutation test for homogeneity of multivariate dispersions Permutation: free Number of permutations: 999 Response: Distances Df Sum Sq Mean Sq F N.Perm Pr(&gt;F) Groups 2 0.008931 0.0044656 1.4188 999 0.235 Residuals 72 0.226611 0.0031474 Pairwise comparisons: (Observed p-value below diagonal, permuted p-value above diagonal) natural protected urban natural 0.36200 0.128 protected 0.36301 0.405 urban 0.12598 0.40392 adonis2(beta_q1f$S ~ type, data = sample_metadata %&gt;% arrange(match(sample,labels(beta_q1f$S))), permutations = 999, strata = sample_metadata %&gt;% arrange(match(sample,labels(beta_q1f$S))) %&gt;% pull(type)) %&gt;% broom::tidy() %&gt;% tt() tinytable_8igavgkbhbwy5t384tz4 .table td.tinytable_css_hun28euq0iut592jwk2h, .table th.tinytable_css_hun28euq0iut592jwk2h { border-bottom: solid 0.1em #d3d8dc; } term df SumOfSqs R2 statistic p.value type 2 0.02226324 0.05258339 1.998067 1 Residual 72 0.40112594 0.94741661 NA NA Total 74 0.42338918 1.00000000 NA NA pairwise.adonis2(beta_q1f$S ~ type*season, data=sample_metadata_row, perm = 999, strata = &quot;region&quot;) $parent_call [1] &quot;beta_q1f$S ~ type * season , strata = region , permutations 999&quot; $natural_vs_protected Df SumOfSqs R2 F Pr(&gt;F) type 1 0.01858 0.04818 4.2067 0.002 ** season 1 0.13428 0.34814 30.3994 0.001 *** type:season 1 0.01199 0.03108 2.7135 0.255 Residual 50 0.22087 0.57261 Total 53 0.38572 1.00000 --- Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 $natural_vs_urban Df SumOfSqs R2 F Pr(&gt;F) type 1 0.014221 0.04503 3.691 0.002 ** season 1 0.073060 0.23133 18.962 0.005 ** type:season 1 0.047453 0.15025 12.316 0.007 ** Residual 47 0.181089 0.57339 Total 50 0.315824 1.00000 --- Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 $protected_vs_urban Df SumOfSqs R2 F Pr(&gt;F) type 1 -0.001311 -0.00992 -0.4856 0.874 season 1 0.014945 0.11305 5.5365 0.124 type:season 1 0.007891 0.05969 2.9233 0.185 Residual 41 0.110674 0.83717 Total 44 0.132200 1.00000 attr(,&quot;class&quot;) [1] &quot;pwadstrata&quot; &quot;list&quot; 7.1.2 Without strata Richness sample_metadata_row&lt;- column_to_rownames(sample_metadata, &quot;sample&quot;) sample_metadata_row &lt;- sample_metadata_row[labels(beta_q0n$S), ] betadisper(beta_q0n$S, sample_metadata$type) %&gt;% permutest(., pairwise = TRUE) Permutation test for homogeneity of multivariate dispersions Permutation: free Number of permutations: 999 Response: Distances Df Sum Sq Mean Sq F N.Perm Pr(&gt;F) Groups 2 0.03602 0.0180094 2.9837 999 0.051 . Residuals 72 0.43459 0.0060359 --- Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 Pairwise comparisons: (Observed p-value below diagonal, permuted p-value above diagonal) natural protected urban natural 0.738000 0.048 protected 0.724845 0.019 urban 0.044422 0.021094 betadisper(beta_q0n$S, sample_metadata$season) %&gt;% permutest(., pairwise = TRUE) Permutation test for homogeneity of multivariate dispersions Permutation: free Number of permutations: 999 Response: Distances Df Sum Sq Mean Sq F N.Perm Pr(&gt;F) Groups 1 0.045726 0.045726 15.566 999 0.001 *** Residuals 73 0.214440 0.002938 --- Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 Pairwise comparisons: (Observed p-value below diagonal, permuted p-value above diagonal) autumn spring autumn 0.001 spring 0.00018133 adonis2(beta_q0n$S ~ type*season, data = sample_metadata %&gt;% arrange(match(sample,labels(beta_q0n$S))), permutations = 999) %&gt;% broom::tidy() %&gt;% tt() tinytable_cvzzvwtz6ptel8geedrx .table td.tinytable_css_dmv8mdbxaxpno5zulpp4, .table th.tinytable_css_dmv8mdbxaxpno5zulpp4 { border-bottom: solid 0.1em #d3d8dc; } term df SumOfSqs R2 statistic p.value type 2 2.4713937 0.09990627 4.204275 0.001 season 1 1.0483711 0.04238048 3.566927 0.001 type:season 2 0.9372685 0.03788915 1.594459 0.004 Residual 69 20.2800898 0.81982411 NA NA Total 74 24.7371231 1.00000000 NA NA pairwise.adonis2(beta_q0n$S ~ type*season, data=sample_metadata_row, perm = 999) $parent_call [1] &quot;beta_q0n$S ~ type * season , strata = Null , permutations 999&quot; $natural_vs_protected Df SumOfSqs R2 F Pr(&gt;F) type 1 1.4635 0.08006 4.7898 0.001 *** season 1 0.9775 0.05347 3.1991 0.001 *** type:season 1 0.5610 0.03069 1.8360 0.013 * Residual 50 15.2773 0.83577 Total 53 18.2792 1.00000 --- Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 $natural_vs_urban Df SumOfSqs R2 F Pr(&gt;F) type 1 1.2906 0.07930 4.3514 0.001 *** season 1 0.6345 0.03899 2.1392 0.001 *** type:season 1 0.4088 0.02512 1.3785 0.088 . Residual 47 13.9396 0.85658 Total 50 16.2735 1.00000 --- Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 $protected_vs_urban Df SumOfSqs R2 F Pr(&gt;F) type 1 0.9002 0.06603 3.2536 0.001 *** season 1 0.9641 0.07072 3.4846 0.001 *** type:season 1 0.4255 0.03121 1.5378 0.042 * Residual 41 11.3433 0.83205 Total 44 13.6329 1.00000 --- Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 attr(,&quot;class&quot;) [1] &quot;pwadstrata&quot; &quot;list&quot; Neutral betadisper(beta_q1n$S, sample_metadata$type) %&gt;% permutest(., pairwise = TRUE) Permutation test for homogeneity of multivariate dispersions Permutation: free Number of permutations: 999 Response: Distances Df Sum Sq Mean Sq F N.Perm Pr(&gt;F) Groups 2 0.09096 0.045478 5.7232 999 0.005 ** Residuals 72 0.57213 0.007946 --- Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 Pairwise comparisons: (Observed p-value below diagonal, permuted p-value above diagonal) natural protected urban natural 0.0110000 0.010 protected 0.0102235 0.799 urban 0.0046867 0.7844374 betadisper(beta_q1n$S, sample_metadata$season) %&gt;% permutest(., pairwise = TRUE) Permutation test for homogeneity of multivariate dispersions Permutation: free Number of permutations: 999 Response: Distances Df Sum Sq Mean Sq F N.Perm Pr(&gt;F) Groups 1 0.0133 0.0133019 2.1964 999 0.147 Residuals 73 0.4421 0.0060562 Pairwise comparisons: (Observed p-value below diagonal, permuted p-value above diagonal) autumn spring autumn 0.142 spring 0.14264 adonis2(beta_q1n$S ~ type*season, data = sample_metadata %&gt;% arrange(match(sample,labels(beta_q1n$S))), permutations = 999) %&gt;% broom::tidy() %&gt;% tt() tinytable_ka5z6kpl11tj3c3pmxnu .table td.tinytable_css_oj0y5gxu17aqx8j6qluc, .table th.tinytable_css_oj0y5gxu17aqx8j6qluc { border-bottom: solid 0.1em #d3d8dc; } term df SumOfSqs R2 statistic p.value type 2 2.8331097 0.12162688 5.312689 0.001 season 1 1.1483346 0.04929861 4.306748 0.001 type:season 2 0.9141128 0.03924334 1.714158 0.011 Residual 69 18.3978927 0.78983117 NA NA Total 74 23.2934498 1.00000000 NA NA pairwise.adonis2(beta_q1n$S ~ type*season, data=sample_metadata_row, perm = 999) $parent_call [1] &quot;beta_q1n$S ~ type * season , strata = Null , permutations 999&quot; $natural_vs_protected Df SumOfSqs R2 F Pr(&gt;F) type 1 1.8601 0.10743 6.7297 0.001 *** season 1 1.0323 0.05962 3.7349 0.002 ** type:season 1 0.6017 0.03475 2.1770 0.010 ** Residual 50 13.8200 0.79819 Total 53 17.3142 1.00000 --- Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 $natural_vs_urban Df SumOfSqs R2 F Pr(&gt;F) type 1 1.4101 0.08840 4.9486 0.001 *** season 1 0.7465 0.04680 2.6197 0.004 ** type:season 1 0.4017 0.02518 1.4097 0.107 Residual 47 13.3922 0.83962 Total 50 15.9504 1.00000 --- Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 $protected_vs_urban Df SumOfSqs R2 F Pr(&gt;F) type 1 0.8917 0.07545 3.8147 0.001 *** season 1 0.9941 0.08412 4.2528 0.001 *** type:season 1 0.3486 0.02950 1.4915 0.083 . Residual 41 9.5836 0.81093 Total 44 11.8179 1.00000 --- Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 attr(,&quot;class&quot;) [1] &quot;pwadstrata&quot; &quot;list&quot; Phylogenetic betadisper(beta_q1p$S, sample_metadata$type) %&gt;% permutest(., pairwise = TRUE) Permutation test for homogeneity of multivariate dispersions Permutation: free Number of permutations: 999 Response: Distances Df Sum Sq Mean Sq F N.Perm Pr(&gt;F) Groups 2 0.05728 0.028642 2.661 999 0.056 . Residuals 72 0.77498 0.010764 --- Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 Pairwise comparisons: (Observed p-value below diagonal, permuted p-value above diagonal) natural protected urban natural 0.050000 0.104 protected 0.059462 0.955 urban 0.111009 0.951525 betadisper(beta_q1p$S, sample_metadata$season) %&gt;% permutest(., pairwise = TRUE) Permutation test for homogeneity of multivariate dispersions Permutation: free Number of permutations: 999 Response: Distances Df Sum Sq Mean Sq F N.Perm Pr(&gt;F) Groups 1 0.01038 0.010385 0.8932 999 0.401 Residuals 73 0.84878 0.011627 Pairwise comparisons: (Observed p-value below diagonal, permuted p-value above diagonal) autumn spring autumn 0.388 spring 0.34774 adonis2(beta_q1p$S ~ type*season, data = sample_metadata %&gt;% arrange(match(sample,labels(beta_q1p$S))), permutations = 999) %&gt;% broom::tidy() %&gt;% tt() tinytable_fcpdb36fht0rr20ri9by .table td.tinytable_css_155dbymq8i20wludwd91, .table th.tinytable_css_155dbymq8i20wludwd91 { border-bottom: solid 0.1em #d3d8dc; } term df SumOfSqs R2 statistic p.value type 2 0.3561228 0.09721296 4.088057 0.002 season 1 0.1880028 0.05132022 4.316297 0.004 type:season 2 0.1138033 0.03106555 1.306387 0.217 Residual 69 3.0053980 0.82040127 NA NA Total 74 3.6633269 1.00000000 NA NA pairwise.adonis2(beta_q1p$S ~ type*season, data=sample_metadata_row, perm = 999) $parent_call [1] &quot;beta_q1p$S ~ type * season , strata = Null , permutations 999&quot; $natural_vs_protected Df SumOfSqs R2 F Pr(&gt;F) type 1 0.29577 0.10235 6.3336 0.001 *** season 1 0.19224 0.06652 4.1165 0.004 ** type:season 1 0.06695 0.02317 1.4337 0.199 Residual 50 2.33495 0.80797 Total 53 2.88992 1.00000 --- Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 $natural_vs_urban Df SumOfSqs R2 F Pr(&gt;F) type 1 0.12582 0.04567 2.3870 0.050 * season 1 0.09019 0.03274 1.7110 0.144 type:season 1 0.06174 0.02241 1.1713 0.331 Residual 47 2.47750 0.89919 Total 50 2.75526 1.00000 --- Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 $protected_vs_urban Df SumOfSqs R2 F Pr(&gt;F) type 1 0.09601 0.06457 3.2849 0.007 ** season 1 0.15237 0.10248 5.2131 0.001 *** type:season 1 0.04012 0.02698 1.3727 0.235 Residual 41 1.19834 0.80597 Total 44 1.48684 1.00000 --- Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 attr(,&quot;class&quot;) [1] &quot;pwadstrata&quot; &quot;list&quot; Functional betadisper(beta_q1f$S, sample_metadata$type) %&gt;% permutest(., pairwise = TRUE) Permutation test for homogeneity of multivariate dispersions Permutation: free Number of permutations: 999 Response: Distances Df Sum Sq Mean Sq F N.Perm Pr(&gt;F) Groups 2 0.008931 0.0044656 1.4188 999 0.231 Residuals 72 0.226611 0.0031474 Pairwise comparisons: (Observed p-value below diagonal, permuted p-value above diagonal) natural protected urban natural 0.36200 0.121 protected 0.36301 0.391 urban 0.12598 0.40392 betadisper(beta_q1f$S, sample_metadata$season) %&gt;% permutest(., pairwise = TRUE) Permutation test for homogeneity of multivariate dispersions Permutation: free Number of permutations: 999 Response: Distances Df Sum Sq Mean Sq F N.Perm Pr(&gt;F) Groups 1 0.000085 0.00008522 0.0307 999 0.862 Residuals 73 0.202452 0.00277331 Pairwise comparisons: (Observed p-value below diagonal, permuted p-value above diagonal) autumn spring autumn 0.868 spring 0.86133 adonis2(beta_q1f$S ~ type, data = sample_metadata %&gt;% arrange(match(sample,labels(beta_q1f$S))), permutations = 999) %&gt;% broom::tidy() %&gt;% tt() tinytable_4uq7lql9hropnc4jb84a .table td.tinytable_css_dw0yt7a9vr6xuf0q5pum, .table th.tinytable_css_dw0yt7a9vr6xuf0q5pum { border-bottom: solid 0.1em #d3d8dc; } term df SumOfSqs R2 statistic p.value type 2 0.02226324 0.05258339 1.998067 0.236 Residual 72 0.40112594 0.94741661 NA NA Total 74 0.42338918 1.00000000 NA NA pairwise.adonis2(beta_q1f$S ~ type*season, data=sample_metadata_row, perm = 999) $parent_call [1] &quot;beta_q1f$S ~ type * season , strata = Null , permutations 999&quot; $natural_vs_protected Df SumOfSqs R2 F Pr(&gt;F) type 1 0.01858 0.04818 4.2067 0.096 . season 1 0.13428 0.34814 30.3994 0.001 *** type:season 1 0.01199 0.03108 2.7135 0.164 Residual 50 0.22087 0.57261 Total 53 0.38572 1.00000 --- Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 $natural_vs_urban Df SumOfSqs R2 F Pr(&gt;F) type 1 0.014221 0.04503 3.691 0.129 season 1 0.073060 0.23133 18.962 0.003 ** type:season 1 0.047453 0.15025 12.316 0.014 * Residual 47 0.181089 0.57339 Total 50 0.315824 1.00000 --- Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 $protected_vs_urban Df SumOfSqs R2 F Pr(&gt;F) type 1 -0.001311 -0.00992 -0.4856 0.806 season 1 0.014945 0.11305 5.5365 0.067 . type:season 1 0.007891 0.05969 2.9233 0.174 Residual 41 0.110674 0.83717 Total 44 0.132200 1.00000 --- Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 attr(,&quot;class&quot;) [1] &quot;pwadstrata&quot; &quot;list&quot; 7.2 Beta diversity plots 7.2.1 Richness beta_q0n$S %&gt;% vegan::metaMDS(., trymax = 500, k = 2, trace=0) %&gt;% vegan::scores() %&gt;% as_tibble(., rownames = &quot;sample&quot;) %&gt;% dplyr::left_join(sample_metadata, by = join_by(sample == sample)) %&gt;% group_by(season) %&gt;% mutate(x_cen = median(NMDS1, na.rm = TRUE)) %&gt;% mutate(y_cen = median(NMDS2, na.rm = TRUE)) %&gt;% ungroup() %&gt;% ggplot(aes(x = NMDS1, y = NMDS2, color = season, fill = season, shape = as.factor(type))) + geom_point(size = 4) + scale_color_manual(values = season_colors) + #scale_shape_manual(values = 1:10) # stat_ellipse(aes(color = beta_q1n_nmds$Groups))+ geom_segment(aes(x = x_cen, y = y_cen, xend = NMDS1, yend = NMDS2), alpha = 0.9) + theme_classic() + theme( axis.text.x = element_text(size = 12), axis.text.y = element_text(size = 12), axis.title = element_text(size = 20, face = &quot;bold&quot;), axis.text = element_text(face = &quot;bold&quot;, size = 18), panel.background = element_blank(), axis.line = element_line(size = 0.5, linetype = &quot;solid&quot;, colour = &quot;black&quot;), legend.text = element_text(size = 16), legend.title = element_text(size = 18), legend.position = &quot;right&quot;, legend.box = &quot;vertical&quot; ) + labs(shape=&quot;Type of pond&quot;) 7.2.2 Neutral beta_q1n$S %&gt;% vegan::metaMDS(., trymax = 500, k = 2, trace=0) %&gt;% vegan::scores() %&gt;% as_tibble(., rownames = &quot;sample&quot;) %&gt;% # filter(!sample %in% c(&quot;EHI01629&quot;, &quot;EHI01630&quot;, &quot;EHI01614&quot;, &quot;EHI01662&quot;, &quot;EHI01446&quot;, &quot;EHI01624&quot;)) %&gt;% dplyr::left_join(sample_metadata, by = join_by(sample == sample)) %&gt;% group_by(type) %&gt;% mutate(x_cen = median(NMDS1, na.rm = TRUE)) %&gt;% mutate(y_cen = median(NMDS2, na.rm = TRUE)) %&gt;% ungroup() %&gt;% ggplot(aes(x = NMDS1, y = NMDS2, color = type, shape = as.factor(season))) + geom_point(size = 4) + # stat_ellipse(aes(color = beta_q1n_nmds$Groups))+ geom_segment(aes(x = x_cen, y = y_cen, xend = NMDS1, yend = NMDS2), alpha = 0.9, show.legend = FALSE) + scale_color_manual(values=type_colors)+ theme_classic() + theme( axis.text.x = element_text(size = 12), axis.text.y = element_text(size = 12), axis.title = element_text(size = 20, face = &quot;bold&quot;), axis.text = element_text(face = &quot;bold&quot;, size = 18), panel.background = element_blank(), axis.line = element_line(size = 0.5, linetype = &quot;solid&quot;, colour = &quot;black&quot;), legend.text = element_text(size = 16), legend.title = element_text(size = 18), legend.position = &quot;right&quot;, legend.box = &quot;vertical&quot; ) + labs(shape=&quot;Season&quot;,color=&#39;Type of pond&#39;) #### In spring beta_q1n$S %&gt;% vegan::metaMDS(., trymax = 500, k = 2, trace=0) %&gt;% vegan::scores() %&gt;% as_tibble(., rownames = &quot;sample&quot;) %&gt;% # filter(!sample %in% c(&quot;EHI01629&quot;, &quot;EHI01630&quot;, &quot;EHI01614&quot;, &quot;EHI01662&quot;, &quot;EHI01446&quot;, &quot;EHI01624&quot;)) %&gt;% dplyr::left_join(sample_metadata, by = join_by(sample == sample)) %&gt;% filter(!region %in% c(&quot;Eskoriatza&quot;,&quot;Villabona&quot;)) %&gt;% # filter(season==&quot;autumn&quot;) %&gt;% filter(season==&quot;spring&quot;) %&gt;% group_by(type) %&gt;% mutate(x_cen = median(NMDS1, na.rm = TRUE)) %&gt;% mutate(y_cen = median(NMDS2, na.rm = TRUE)) %&gt;% ungroup() %&gt;% ggplot(aes(x = NMDS1, y = NMDS2, color = type)) +#, shape = as.factor(type) geom_point(size = 4) + geom_segment(aes(x = x_cen, y = y_cen, xend = NMDS1, yend = NMDS2), alpha = 0.9, show.legend = FALSE) + scale_color_manual(values=type_colors)+ theme_classic() + theme( axis.text.x = element_text(size = 12), axis.text.y = element_text(size = 12), axis.title = element_text(size = 20, face = &quot;bold&quot;), axis.text = element_text(face = &quot;bold&quot;, size = 18), panel.background = element_blank(), axis.line = element_line(size = 0.5, linetype = &quot;solid&quot;, colour = &quot;black&quot;), legend.text = element_text(size = 16), legend.title = element_text(size = 18), legend.position = &quot;right&quot;, legend.box = &quot;vertical&quot; ) + labs(color=&#39;Type of pond&#39;) 7.2.2.1 In autumn beta_q1n$S %&gt;% vegan::metaMDS(., trymax = 500, k = 2, trace=0) %&gt;% vegan::scores() %&gt;% as_tibble(., rownames = &quot;sample&quot;) %&gt;% # filter(!sample %in% c(&quot;EHI01629&quot;, &quot;EHI01630&quot;, &quot;EHI01614&quot;, &quot;EHI01662&quot;, &quot;EHI01446&quot;, &quot;EHI01624&quot;)) %&gt;% dplyr::left_join(sample_metadata, by = join_by(sample == sample)) %&gt;% filter(!region %in% c(&quot;Eskoriatza&quot;,&quot;Villabona&quot;)) %&gt;% filter(season==&quot;autumn&quot;) %&gt;% # filter(season==&quot;spring&quot;) %&gt;% group_by(type) %&gt;% mutate(x_cen = median(NMDS1, na.rm = TRUE)) %&gt;% mutate(y_cen = median(NMDS2, na.rm = TRUE)) %&gt;% ungroup() %&gt;% ggplot(aes(x = NMDS1, y = NMDS2, color = type)) + geom_point(size = 4) + geom_segment(aes(x = x_cen, y = y_cen, xend = NMDS1, yend = NMDS2), alpha = 0.9, show.legend = FALSE) + scale_color_manual(values=type_colors)+ theme_classic() + theme( axis.text.x = element_text(size = 12), axis.text.y = element_text(size = 12), axis.title = element_text(size = 20, face = &quot;bold&quot;), axis.text = element_text(face = &quot;bold&quot;, size = 18), panel.background = element_blank(), axis.line = element_line(size = 0.5, linetype = &quot;solid&quot;, colour = &quot;black&quot;), legend.text = element_text(size = 16), legend.title = element_text(size = 18), legend.position = &quot;right&quot;, legend.box = &quot;vertical&quot; ) + labs(color=&#39;Type of pond&#39;) 7.2.3 Phylogenetic beta_q1p$S %&gt;% vegan::metaMDS(., trymax = 500, k = 2, trace=0) %&gt;% vegan::scores() %&gt;% as_tibble(., rownames = &quot;sample&quot;) %&gt;% # filter(!sample %in% c(&quot;EHI01629&quot;, &quot;EHI01630&quot;, &quot;EHI01614&quot;, &quot;EHI01662&quot;, &quot;EHI01446&quot;, &quot;EHI01624&quot;)) %&gt;% dplyr::left_join(sample_metadata, by = join_by(sample == sample)) %&gt;% group_by(season) %&gt;% mutate(x_cen = median(NMDS1, na.rm = TRUE)) %&gt;% mutate(y_cen = median(NMDS2, na.rm = TRUE)) %&gt;% ungroup() %&gt;% ggplot(aes(x = NMDS1, y = NMDS2, color = season, shape = as.factor(type))) + geom_point(size = 4) + geom_segment(aes(x = x_cen, y = y_cen, xend = NMDS1, yend = NMDS2), alpha = 0.9, show.legend = FALSE) + scale_color_manual(values=season_colors)+ theme_classic() + theme( axis.text.x = element_text(size = 12), axis.text.y = element_text(size = 12), axis.title = element_text(size = 20, face = &quot;bold&quot;), axis.text = element_text(face = &quot;bold&quot;, size = 18), panel.background = element_blank(), axis.line = element_line(size = 0.5, linetype = &quot;solid&quot;, colour = &quot;black&quot;), legend.text = element_text(size = 16), legend.title = element_text(size = 18), legend.position = &quot;right&quot;, legend.box = &quot;vertical&quot; ) + labs(shape=&quot;Type of pond&quot;,color=&#39;Season&#39;) beta_q1p$S %&gt;% vegan::metaMDS(., trymax = 500, k = 2, trace=0) %&gt;% vegan::scores() %&gt;% as_tibble(., rownames = &quot;sample&quot;) %&gt;% # filter(!sample %in% c(&quot;EHI01629&quot;, &quot;EHI01630&quot;, &quot;EHI01614&quot;, &quot;EHI01662&quot;, &quot;EHI01446&quot;, &quot;EHI01624&quot;)) %&gt;% dplyr::left_join(sample_metadata, by = join_by(sample == sample)) %&gt;% group_by(region) %&gt;% mutate(x_cen = median(NMDS1, na.rm = TRUE)) %&gt;% mutate(y_cen = median(NMDS2, na.rm = TRUE)) %&gt;% ungroup() %&gt;% ggplot(aes(x = NMDS1, y = NMDS2, color = region, shape = as.factor(season))) + geom_point(size = 4) + # stat_ellipse(aes(color = beta_q1n_nmds$Groups))+ geom_segment(aes(x = x_cen, y = y_cen, xend = NMDS1, yend = NMDS2), alpha = 0.9, show.legend = FALSE) + scale_color_manual(values=location_colors)+ theme_classic() + theme( axis.text.x = element_text(size = 12), axis.text.y = element_text(size = 12), axis.title = element_text(size = 20, face = &quot;bold&quot;), axis.text = element_text(face = &quot;bold&quot;, size = 18), panel.background = element_blank(), axis.line = element_line(size = 0.5, linetype = &quot;solid&quot;, colour = &quot;black&quot;), legend.text = element_text(size = 16), legend.title = element_text(size = 18), legend.position = &quot;right&quot;, legend.box = &quot;vertical&quot; ) + labs(shape=&quot;Season&quot;,color=&#39;Type of pond&#39;)+ geom_text(aes(label = sample), size=4) 7.2.4 Functional beta_q1f$S %&gt;% vegan::metaMDS(., trymax = 500, k = 2, trace=0) %&gt;% vegan::scores() %&gt;% as_tibble(., rownames = &quot;sample&quot;) %&gt;% # filter(!sample %in% c(&quot;EHI01629&quot;, &quot;EHI01630&quot;, &quot;EHI01614&quot;, &quot;EHI01662&quot;, &quot;EHI01446&quot;, &quot;EHI01624&quot;)) %&gt;% dplyr::left_join(sample_metadata, by = join_by(sample == sample)) %&gt;% group_by(type) %&gt;% mutate(x_cen = median(NMDS1, na.rm = TRUE)) %&gt;% mutate(y_cen = median(NMDS2, na.rm = TRUE)) %&gt;% ungroup() %&gt;% ggplot(aes(x = NMDS1, y = NMDS2, color = type, shape = season)) + geom_point(size = 4) + geom_segment(aes(x = x_cen, y = y_cen, xend = NMDS1, yend = NMDS2), alpha = 0.9, show.legend = FALSE) + scale_color_manual(values=type_colors)+ theme_classic() + theme( axis.text.x = element_text(size = 12), axis.text.y = element_text(size = 12), axis.title = element_text(size = 20, face = &quot;bold&quot;), axis.text = element_text(face = &quot;bold&quot;, size = 18), panel.background = element_blank(), axis.line = element_line(size = 0.5, linetype = &quot;solid&quot;, colour = &quot;black&quot;), legend.text = element_text(size = 16), legend.title = element_text(size = 18), legend.position = &quot;right&quot;, legend.box = &quot;vertical&quot; ) + labs(shape=&quot;Season&quot;,color=&#39;Type of pond&#39;) "],["structural-zeros.html", "Chapter 8 Structural zeros 8.1 Enrichment analysis 8.2 Ancombc2", " Chapter 8 Structural zeros 8.1 Enrichment analysis 8.2 Ancombc2 8.2.1 Season 8.2.1.1 MAG level 8.2.1.2 Phylum level taxon lfc_seasonspring p_seasonspring 1 p__Cyanobacteriota 3.590385 0.003141004 2 p__Verrucomicrobiota 2.903370 0.004843479 8.2.1.3 Family level taxon lfc_seasonspring p_seasonspring 1 f___6 -4.214869 0.0007590520 2 f__UBA3637 3.748437 0.0008081703 3 f__Peptostreptococcaceae 3.843270 0.0031726734 4 f__Muribaculaceae 3.946386 0.0044607642 5 f__CAG-239 3.225041 0.0047340434 6 f__Mycoplasmoidaceae 3.768548 0.0082886337 7 f__Cellulosilyticaceae 2.845212 0.0131995386 8 f__Coprobacillaceae -2.724408 0.0181337797 9 f__DUVY01 -2.817130 0.0189445012 10 f__Akkermansiaceae 2.780030 0.0282460909 11 f__Gastranaerophilaceae 2.758508 0.0299564345 12 f__Lachnospiraceae -1.524644 0.0304690717 8.2.1.4 Genera taxon lfc_seasonspring p_seasonspring 1 g__Amedibacillus -5.507327 0.0001050656 2 g__Akkermansia 5.777361 0.0002602703 3 g__Buttiauxella -5.104111 0.0004793856 4 g__Mycoplasma_L 5.002864 0.0006139272 5 g__Alistipes 3.534307 0.0010538954 6 g__CAJGBR01 4.249959 0.0010928787 7 g__RGIG7389 4.177297 0.0011253905 8 g___36 -4.214869 0.0013525154 9 g__UMGS1202 4.171683 0.0021848009 10 g__WRDF01 -3.464280 0.0028244618 11 g__Anaerobium -3.523425 0.0036770527 12 g__Hungatella_A -4.381835 0.0051327144 13 g__HGM05232 3.946386 0.0063245223 14 g__Avirikenella 3.742697 0.0077311101 15 g__Evtepia 3.539588 0.0113567374 16 g__UBA7488 2.771108 0.0128264964 17 g___1 3.197741 0.0137327185 18 g__JAGAJR01 3.224199 0.0171020567 19 g__Copranaerobaculum -3.076056 0.0172105317 20 g__Massiliimalia -2.103388 0.0174098735 21 g___4 2.845212 0.0193843266 22 g__Coprobacillus -2.724408 0.0257317008 23 g___49 -2.817130 0.0261276301 24 g___12 2.680947 0.0273256752 25 g__Romboutsia_D 2.904895 0.0301345037 26 g__Massilioclostridium -2.405263 0.0303227992 27 g__Phocea 2.748662 0.0443081865 28 g___5 2.679159 0.0447357995 29 g__Gallalistipes 2.668968 0.0487297569 "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
